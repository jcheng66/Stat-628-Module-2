<!DOCTYPE html>
<!-- saved from url=(0096)http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/ -->
<html class="gr__developintelligence_com ua-windows_nt ua-windows_nt-10 ua-windows_nt-10-0 ua-chrome ua-chrome-63 ua-chrome-63-0 ua-chrome-63-0-3239 ua-chrome-63-0-3239-132 ua-desktop ua-desktop-windows ua-webkit ua-webkit-537 ua-webkit-537-36 js applicationcache geolocation history postmessage websockets localstorage sessionstorage websqldatabase webworkers hashchange audio canvas canvastext video webgl cssgradients multiplebgs opacity rgba inlinesvg hsla supports svgclippaths smil no-touchevents fontface generatedcontent textshadow indexeddb indexeddb-deletedatabase cssanimations backgroundsize borderimage borderradius boxshadow flexbox cssreflections csstransforms csstransforms3d csstransitions" lang="en-US" xmlns:fb="http://ogp.me/ns/fb#" prefix="og: http://ogp.me/ns#" data-useragent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36" style="overflow-y: auto;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	

	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Predicting Yelp Stars from Reviews with scikit-learn and Python | DevelopIntelligence Blog</title>

<!-- This site is optimized with the Yoast SEO plugin v5.1 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Guide to doing simple data science with Python">
<link rel="canonical" href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Predicting Yelp Stars from Reviews with scikit-learn and Python | DevelopIntelligence Blog">
<meta property="og:description" content="Guide to doing simple data science with Python">
<meta property="og:url" content="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/">
<meta property="og:site_name" content="DevelopIntelligence Blog">
<meta property="article:publisher" content="https://www.facebook.com/DevelopIntelligence/">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Yelp">
<meta property="article:section" content="Big Data">
<meta property="article:published_time" content="2017-03-14T20:10:19+00:00">
<meta property="article:modified_time" content="2017-04-08T02:12:39+00:00">
<meta property="og:updated_time" content="2017-04-08T02:12:39+00:00">
<meta property="og:image" content="http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9.png">
<meta property="og:image:width" content="700">
<meta property="og:image:height" content="400">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="Guide to doing simple data science with Python">
<meta name="twitter:title" content="Predicting Yelp Stars from Reviews with scikit-learn and Python | DevelopIntelligence Blog">
<meta name="twitter:image" content="http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9.png">
<meta name="twitter:creator" content="@sixhobbits">
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="http://js.hs-scripts.com/">
<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="DevelopIntelligence Blog » Feed" href="http://www.developintelligence.com/blog/feed/">
<link rel="alternate" type="application/rss+xml" title="DevelopIntelligence Blog » Comments Feed" href="http://www.developintelligence.com/blog/comments/feed/">
			<!-- For iPad Retina display -->
			<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/">
				<script src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/550954.js.下载" type="text/javascript" id="hs-script-loader"></script><script type="text/javascript" async="" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/analytics.js.下载"></script><script src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/550954.js(1).下载" type="text/javascript" id="hs-analytics"></script><script type="text/javascript" async="" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/insight.min.js.下载"></script><script id="facebook-jssdk" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/sdk.js.下载"></script><script async="" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/gtm.js.下载"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.developintelligence.com\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/wp-emoji-release.min.js.下载" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="ts_fab_css-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/ts-fab.min.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-stylesheet-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="child-style-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/style.css" type="text/css" media="all">
<!--[if lte IE 9]>
<link rel='stylesheet' id='avada-shortcodes-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/shortcodes.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="fontawesome-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/font-awesome.css" type="text/css" media="all">
<!--[if lte IE 9]>
<link rel='stylesheet' id='avada-IE-fontawesome-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/fonts/fontawesome/font-awesome.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<!--[if lte IE 8]>
<link rel='stylesheet' id='avada-IE8-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/css/ie8.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<!--[if IE]>
<link rel='stylesheet' id='avada-IE-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/css/ie.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="avada-iLightbox-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/ilightbox.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-animations-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/animations.css" type="text/css" media="all">
<link rel="stylesheet" id="wordpress-popular-posts-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/wpp.css" type="text/css" media="all">
<link rel="stylesheet" id="fusion-builder-shortcodes-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/fusion-shortcodes.min.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-dynamic-css-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/avada-3452.css" type="text/css" media="all">
<link rel="stylesheet" id="avada_google_fonts-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/css" type="text/css" media="all">
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/jquery.js.下载"></script>
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/jquery-migrate.min.js.下载"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.developintelligence.com\/blog\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/crayon.min.js.下载"></script>
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/ts-fab.min.js.下载"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/html5shiv.js?ver=5.0.6'></script>
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/excanvas.js?ver=5.0.6'></script>
<![endif]-->
<link rel="https://api.w.org/" href="http://www.developintelligence.com/blog/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.developintelligence.com/blog/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.developintelligence.com/blog/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="http://www.developintelligence.com/blog/?p=3452">
<link rel="alternate" type="application/json+oembed" href="http://www.developintelligence.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F03%2Fpredicting-yelp-star-ratings-review-text-python%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.developintelligence.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F03%2Fpredicting-yelp-star-ratings-review-text-python%2F&amp;format=xml">


<meta property="fb:app_id" content="708166696026776">	<style>
	.ts-fab-list li a { background-color: #ffffff; border: 1px solid #ffffff; color: #888; }
	.ts-fab-list li.active a { background-color: #a5a5a5; border: 1px solid #a5a5a5; color: #fff; }
	.ts-fab-tab { background-color: #ffffff; border: 2px solid #d2d2d2; color: #888; }
	</style>
	

<!-- Plugin: Open external links a new window. Plugin by Kristian Risager Larsen, http://kristianrisagerlarsen.dk . Download it at http://wordpress.org/extend/plugins/open-external-links-in-a-new-window/ -->
<script type="text/javascript">//<![CDATA[
	function external_links_in_new_windows_loop() {
		if (!document.links) {
			document.links = document.getElementsByTagName('a');
		}
		var change_link = false;
		var force = '';
		var ignore = '';

		for (var t=0; t<document.links.length; t++) {
			var all_links = document.links[t];
			change_link = false;
			
			if(document.links[t].hasAttribute('onClick') == false) {
				// forced if the address starts with http (or also https), but does not link to the current domain
				if(all_links.href.search(/^http/) != -1 && all_links.href.search('www.developintelligence.com') == -1) {
					// alert('Changeda '+all_links.href);
					change_link = true;
				}
					
				if(force != '' && all_links.href.search(force) != -1) {
					// forced
					// alert('force '+all_links.href);
					change_link = true;
				}
				
				if(ignore != '' && all_links.href.search(ignore) != -1) {
					// alert('ignore '+all_links.href);
					// ignored
					change_link = false;
				}

				if(change_link == true) {
					// alert('Changed '+all_links.href);
					document.links[t].setAttribute('onClick', 'javascript:window.open(\''+all_links.href+'\'); return false;');
					document.links[t].removeAttribute('target');
				}
			}
		}
	}
	
	// Load
	function external_links_in_new_windows_load(func)
	{	
		var oldonload = window.onload;
		if (typeof window.onload != 'function'){
			window.onload = func;
		} else {
			window.onload = function(){
				oldonload();
				func();
			}
		}
	}

	external_links_in_new_windows_load(external_links_in_new_windows_loop);
	//]]></script>

				<!-- WordPress Popular Posts v3.3.4 -->
				<script type="text/javascript">

					var sampling_active = 0;
					var sampling_rate   = 100;
					var do_request = false;

					if ( !sampling_active ) {
						do_request = true;
					} else {
						var num = Math.floor(Math.random() * sampling_rate) + 1;
						do_request = ( 1 === num );
					}

					if ( do_request ) {

						/* Create XMLHttpRequest object and set variables */
						var xhr = ( window.XMLHttpRequest )
						  ? new XMLHttpRequest()
						  : new ActiveXObject( "Microsoft.XMLHTTP" ),
						url = 'http://www.developintelligence.com/blog/wp-admin/admin-ajax.php',
						params = 'action=update_views_ajax&token=662404f2b5&wpp_id=3452';
						/* Set request method and target URL */
						xhr.open( "POST", url, true );
						/* Set request header */
						xhr.setRequestHeader( "Content-type", "application/x-www-form-urlencoded" );
						/* Hook into onreadystatechange */
						xhr.onreadystatechange = function() {
							if ( 4 === xhr.readyState && 200 === xhr.status ) {
								if ( window.console && window.console.log ) {
									window.console.log( xhr.responseText );
								}
							}
						};
						/* Send request */
						xhr.send( params );

					}

				</script>
				<!-- End WordPress Popular Posts v3.3.4 -->
				<style type="text/css" id="syntaxhighlighteranchor"></style>

	
	<script type="text/javascript">
		var doc = document.documentElement;
		doc.setAttribute('data-useragent', navigator.userAgent);
	</script>

	<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MP6C47');</script>
<!-- End Google Tag Manager -->
	<link rel="stylesheet" type="text/css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/prettify.css"><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in{animation-duration:250ms;animation-name:fb_bounce_in}.fb_customer_chat_bounce_out{animation-duration:250ms;animation-name:fb_fade_out}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{height:100%;overflow:hidden;position:fixed;width:100%}@keyframes fb_fade_out{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_in{0%{opacity:0;transform:scale(.8, .8);transform-origin:100% 100%}10%{opacity:.1}20%{opacity:.2}30%{opacity:.3}40%{opacity:.4}50%{opacity:.5}60%{opacity:.6}70%{opacity:.7}80%{opacity:.8;transform:scale(1.03, 1.03)}90{opacity:.9}100%{opacity:1;transform:scale(1, 1)}}</style></head>
<body class="single single-post postid-3452 single-format-standard fusion-body no-tablet-sticky-header no-mobile-sticky-header no-mobile-slidingbar no-totop no-mobile-totop mobile-logo-pos-left layout-wide-mode has-sidebar fusion-top-header menu-text-align-center mobile-menu-design-modern fusion-image-hovers fusion-show-pagination-text do-animate" data-gr-c-s-loaded="true">
				<div id="wrapper" class="">
		<div id="home" style="position:relative;top:1px;"></div>
				
		
			<header class="fusion-header-wrapper fusion-is-sticky">
				<div class="fusion-header-v1 fusion-logo-left fusion-sticky-menu-1 fusion-sticky-logo-1 fusion-mobile-logo-1 fusion-mobile-menu-design-modern ">
					<div class="fusion-header-sticky-height" style="display: block; height: 65px; overflow: visible;"></div>
<div class="fusion-header fusion-sticky-shadow" style="top: 0px; height: 65px; overflow: visible;">
	<div class="fusion-row" style="padding-top: 0px; padding-bottom: 0px;">
		
<div class="fusion-logo" data-margin-top="10px" data-margin-bottom="10px" data-margin-left="0px" data-margin-right="0px" style="margin-top: 7.5px; margin-bottom: 7.5px;">
				<a class="fusion-logo-link" href="http://www.developintelligence.com/">
						<img src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/di-logo.jpg" width="340" height="50" alt="DevelopIntelligence Blog" class="fusion-logo-1x fusion-standard-logo">

															<img src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/di-logo@2x.jpg" width="340" height="50" alt="DevelopIntelligence Blog" style="max-height: 50px; height: auto;" class="fusion-standard-logo fusion-logo-2x">
			
			<!-- mobile logo -->
											<img src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/di-logo.jpg" width="340" height="50" alt="DevelopIntelligence Blog" class="fusion-logo-1x fusion-mobile-logo-1x">

														<img src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/di-logo@2x.jpg" width="340" height="50" alt="DevelopIntelligence Blog" style="max-height: 50px; height: auto;" class="fusion-logo-2x fusion-mobile-logo-2x">
							
			<!-- sticky header logo -->
											<img src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/di-logo.jpg" width="340" height="50" alt="DevelopIntelligence Blog" class="fusion-logo-1x fusion-sticky-logo-1x" data-logo-height="50" data-logo-width="340" style="height: 50px;">

														<img src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/di-logo@2x.jpg" width="340" height="50" alt="DevelopIntelligence Blog" style="max-height: 50px;" class="fusion-logo-2x fusion-sticky-logo-2x">
									</a>
		</div>		<nav class="fusion-main-menu" style=""><ul id="menu-main-menu" class="fusion-menu"><li id="menu-item-1122" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1122"><a href="http://www.developintelligence.com/" style="line-height: 65px; height: 65px;"><span class="menu-text">Home</span></a></li><li id="menu-item-6808" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6808"><a href="http://www.developintelligence.com/solutions" style="line-height: 65px; height: 65px;"><span class="menu-text">Solutions</span></a></li><li id="menu-item-6809" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6809"><a href="http://www.developintelligence.com/catalog" style="line-height: 65px; height: 65px;"><span class="menu-text">Courses</span></a></li><li id="menu-item-12" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-12"><a href="http://www.developintelligence.com/blog/why-developintelligence/" style="line-height: 65px; height: 65px;"><span class="menu-text">Why Us</span></a></li><li id="menu-item-6810" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6810 fusion-last-menu-item"><a href="http://www.developintelligence.com/contact-developintelligence" style="line-height: 65px; height: 65px;"><span class="menu-text">Contact</span></a></li></ul></nav><nav class="fusion-main-menu fusion-sticky-menu"><ul id="menu-main-menu-1" class="fusion-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1122"><a href="http://www.developintelligence.com/" style="line-height: 65px; height: 65px;"><span class="menu-text">Home</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6808"><a href="http://www.developintelligence.com/solutions" style="line-height: 65px; height: 65px;"><span class="menu-text">Solutions</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6809"><a href="http://www.developintelligence.com/catalog" style="line-height: 65px; height: 65px;"><span class="menu-text">Courses</span></a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-12"><a href="http://www.developintelligence.com/blog/why-developintelligence/" style="line-height: 65px; height: 65px;"><span class="menu-text">Why Us</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6810 fusion-last-menu-item"><a href="http://www.developintelligence.com/contact-developintelligence" style="line-height: 65px; height: 65px;"><span class="menu-text">Contact</span></a></li></ul></nav>			<div class="fusion-mobile-menu-icons">
							<a href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/#" class="fusion-icon fusion-icon-bars"></a>
		
		
			</div>


<nav class="fusion-mobile-nav-holder" style="display: none;"><ul id="menu-main-menu" class="fusion-menu"><li id="mobile-menu-item-1122" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/"><span class="menu-text">Home</span></a></li><li id="mobile-menu-item-6808" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/solutions"><span class="menu-text">Solutions</span></a></li><li id="mobile-menu-item-6809" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/catalog"><span class="menu-text">Courses</span></a></li><li id="mobile-menu-item-12" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/blog/why-developintelligence/"><span class="menu-text">Why Us</span></a></li><li id="mobile-menu-item-6810" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/contact-developintelligence"><span class="menu-text">Contact</span></a></li></ul></nav>

	<nav class="fusion-mobile-nav-holder fusion-mobile-sticky-nav-holder" style="display: none;"><ul id="menu-main-menu-1" class="fusion-menu"><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/"><span class="menu-text">Home</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/solutions"><span class="menu-text">Solutions</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/catalog"><span class="menu-text">Courses</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/blog/why-developintelligence/"><span class="menu-text">Why Us</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/contact-developintelligence"><span class="menu-text">Contact</span></a></li></ul></nav>
	</div>
</div>
				</div>
				<div class="fusion-clearfix"></div>
			</header>
					
		<div id="sliders-container">
					</div>
				
					<div class="fusion-page-title-bar fusion-page-title-bar-none fusion-page-title-bar-center">
	<div class="fusion-page-title-row">
		<div class="fusion-page-title-wrapper">
			<div class="fusion-page-title-captions">

																			<h1 class="entry-title" data-fontsize="34" data-lineheight="47">Predicting Yelp Stars from Reviews with scikit-learn and Python</h1>

									
													
			</div>

			
		</div>
	</div>
</div>
		
		
		
						<div id="main" class="clearfix width-100" style="padding-left:30px;padding-right:30px">
			<div class="fusion-row" style="max-width:100%;">

<div id="content" style="float: left;">

			<div class="single-navigation clearfix">
						<div class="fusion-sharing-box fusion-single-sharing-box share-box">
				<h4 data-fontsize="18" data-lineheight="27">Share This Article</h4>
				<div class="fusion-social-networks boxed-icons"><div class="fusion-social-networks-wrapper"><a class="fusion-social-network-icon fusion-tooltip fusion-facebook fusion-icon-facebook" style="color:#ffffff;background-color:#3b5998;border-color:#3b5998;border-radius:4px;" href="http://www.facebook.com/sharer.php?m2w&amp;s=100&amp;p[url]=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/&amp;p[images][0]=http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9.png&amp;p[title]=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Facebook" data-toggle="tooltip" title="" data-original-title="Facebook"><span class="screen-reader-text">Facebook</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-twitter fusion-icon-twitter" style="color:#ffffff;background-color:#55acee;border-color:#55acee;border-radius:4px;" href="https://twitter.com/share?text=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python&amp;url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F03%2Fpredicting-yelp-star-ratings-review-text-python%2F" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Twitter" data-toggle="tooltip" title="" data-original-title="Twitter"><span class="screen-reader-text">Twitter</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-linkedin fusion-icon-linkedin" style="color:#ffffff;background-color:#0077b5;border-color:#0077b5;border-radius:4px;" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/&amp;title=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python&amp;summary=In%20this%20post%2C%20we%26%2339%3Bll%20look%20at%20reviews%20from%20the%20Yelp%20Dataset%20Challenge.%20We%26%2339%3Bll%20train%20a%20machine%20learning%20system%20to%20predict%20the%20star-rating%20of%20a%20review%20based%20only%20on%20its%20text.%20For%20example%2C%20if%20the%20text%20says%20%26quot%3BEverything%20was%20great%21%20Best%20stay%20ever%21%21%26quot%3B%20we%20would%20expect%20a%205-star%20rating.%20If%20the%20text%20says%20%26quot%3BWorst%20stay%20of" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Linkedin" data-toggle="tooltip" title="" data-original-title="Linkedin"><span class="screen-reader-text">Linkedin</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-reddit fusion-icon-reddit" style="color:#ffffff;background-color:#ff4500;border-color:#ff4500;border-radius:4px;" href="http://reddit.com/submit?url=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/&amp;title=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Reddit" data-toggle="tooltip" title="" data-original-title="Reddit"><span class="screen-reader-text">Reddit</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-googleplus fusion-icon-googleplus" style="color:#ffffff;background-color:#dc4e41;border-color:#dc4e41;border-radius:4px;" href="https://plus.google.com/share?url=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/" onclick="javascript:window.open(this.href,&#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Google+" data-toggle="tooltip" title="" data-original-title="Google+"><span class="screen-reader-text">Google+</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-pinterest fusion-icon-pinterest" style="color:#ffffff;background-color:#bd081c;border-color:#bd081c;border-radius:4px;" href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F03%2Fpredicting-yelp-star-ratings-review-text-python%2F&amp;description=In%20this%20post%2C%20we%26%2339%3Bll%20look%20at%20reviews%20from%20the%20Yelp%20Dataset%20Challenge.%20We%26%2339%3Bll%20train%20a%20machine%20learning%20system%20to%20predict%20the%20star-rating%20of%20a%20review%20based%20only%20on%20its%20text.%20For%20example%2C%20if%20the%20text%20says%20%26quot%3BEverything%20was%20great%21%20Best%20stay%20ever%21%21%26quot%3B%20we%20would%20expect%20a%205-star%20rating.%20If%20the%20text%20says%20%26quot%3BWorst%20stay%20of&amp;media=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2Fwp-content%2Fuploads%2F2017%2F03%2FCreating-Persistent-9.png" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Pinterest" data-toggle="tooltip" title="" data-original-title="Pinterest"><span class="screen-reader-text">Pinterest</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-mail fusion-icon-mail fusion-last-social-icon" style="color:#ffffff;background-color:#000000;border-color:#000000;border-radius:4px;" href="mailto:?subject=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python&amp;body=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/" target="_self" rel="noopener noreferrer" data-placement="top" data-title="Email" data-toggle="tooltip" title="" data-original-title="Email"><span class="screen-reader-text">Email</span></a><div class="fusion-clearfix"></div></div></div>			</div>
						<a href="http://www.developintelligence.com/blog/2017/03/running-apache-spark-jupyter-notebook/" rel="prev">Previous</a>			<a href="http://www.developintelligence.com/blog/2017/03/gung-ho-effect-measuring-operational-efficiency/" rel="next">Next</a>		</div>
	
			<article id="post-3452" class="post post-3452 type-post status-publish format-standard has-post-thumbnail hentry category-big-data category-python tag-python tag-yelp">
										<span class="entry-title" style="display: none;">Predicting Yelp Stars from Reviews with scikit-learn and Python</span>
			
																								<div class="fusion-flexslider flexslider post-slideshow fusion-post-slideshow">
							<ul class="slides">
																																																				<li class="flex-active-slide" style="width: 100%; float: left; margin-right: -100%; position: relative; opacity: 1; display: block; z-index: 2;">
																					<a href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/Creating-Persistent-9.png" data-rel="iLightbox[gallery3452]" title="" data-title="creating-persistent-9" data-caption="">
												<span class="screen-reader-text">View Larger Image</span>
												<img width="700" height="400" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/Creating-Persistent-9.png" class="attachment-full size-full wp-post-image" alt="creating-persistent-9" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9-200x114.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9-400x229.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9-600x343.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9.png 700w" sizes="(max-width: 800px) 100vw, 1315px" draggable="false">											</a>
																			</li>
																																																																																																																																																																											</ul>
						<ol class="flex-control-nav flex-control-paging"></ol><ul class="flex-direction-nav"><li><a class="flex-prev flex-disabled" href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/#" tabindex="-1"></a></li><li><a class="flex-next flex-disabled" href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/#" tabindex="-1"></a></li></ul></div>
																		
						<div class="post-content">
				<p>In this post, we’ll look at reviews from the Yelp Dataset Challenge. We’ll train a machine learning system to predict the star-rating of a review based only on its text. For example, if the text says “Everything was great! Best stay ever!!” we would expect a 5-star rating. If the text says “Worst stay of my life. Avoid at all costs”, we would expect a 1-star rating. Instead of writing a series of rules to work out whether some text is positive or negative, we can train a machine learning classifier to “learn” the difference between positive and negative reviews by giving it labelled examples.</p>
<p>This post follows closely from the previous one: <a href="http://www.developintelligence.com/blog/2017/02/analyzing-4-million-yelp-reviews-python-aws-ec2-instance/">Analyzing 4 Million Yelp Reviews with Python on AWS</a>. You’re strongly encouraged to go through that one first. In particular, we will not be showing how to set up an EC2 Spot instance with adequate memory and processing power to handle this large dataset, but the same setup was used to run the analysis for this post.</p>
<div class="fusion-button-wrapper fusion-aligncenter">
<style type="text/css" scoped="scoped">.fusion-button.button-1 .fusion-button-text, .fusion-button.button-1 i {color:#ffffff;}.fusion-button.button-1 {border-width:0px;border-color:#ffffff;}.fusion-button.button-1 .fusion-button-icon-divider{border-color:#ffffff;}.fusion-button.button-1:hover .fusion-button-text, .fusion-button.button-1:hover i,.fusion-button.button-1:focus .fusion-button-text, .fusion-button.button-1:focus i,.fusion-button.button-1:active .fusion-button-text, .fusion-button.button-1:active{color:#ffffff;}.fusion-button.button-1:hover, .fusion-button.button-1:focus, .fusion-button.button-1:active{border-width:0px;border-color:#ffffff;}.fusion-button.button-1:hover .fusion-button-icon-divider, .fusion-button.button-1:hover .fusion-button-icon-divider, .fusion-button.button-1:active .fusion-button-icon-divider{border-color:#ffffff;}.fusion-button.button-1{background: #e9873d;<br />					background-image: -webkit-gradient( linear, left bottom, left top, from( #b16931 ), to( #e9873d ) );<br />					background-image: -webkit-linear-gradient( bottom, #b16931, #e9873d );<br />					background-image:   -moz-linear-gradient( bottom, #b16931, #e9873d );<br />					background-image:     -o-linear-gradient( bottom, #b16931, #e9873d );<br />					background-image: linear-gradient( to top, #b16931, #e9873d );}.fusion-button.button-1:hover,.button-1:focus,.fusion-button.button-1:active{background: #f47e24;}.fusion-button.button-1{width:auto;}</style>
<p><a class="fusion-button button-flat button-round button-xlarge button-custom button-1" href="http://www.developintelligence.com/catalog/devops/python" target="_self"><span class="fusion-button-text">Get Python Training for Teams</span></a></p>
</div>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-3451-30j0zll"></a>Introduction and Overview</h2>
<p>This post will show how to implement and report on a (supervised) machine-learning based system of the Yelp reviews. Specifically, this post will explain how to use the popular Python library scikit-learn to:</p>
<ul>
<li>convert text data into TF-IDF vectors</li>
<li>split the data into a training and test set</li>
<li>classify the text data using a LinearSVM</li>
<li>evaluate our classifier using precision, recall and a confusion matrix</li>
</ul>
<p>In addition, this post will explain the terms TF-IDF, SVM, precision, recall, and confusion matrix.</p>
<p>In order to follow along, you should have at least basic Python knowledge. As the dataset we’re working with is relatively large, you’ll need a machine with at least 32GB of RAM, and preferably more. <a href="http://www.developintelligence.com/blog/2017/02/analyzing-4-million-yelp-reviews-python-aws-ec2-instance/">The previous post</a> demonstrated how to set up an EC2 Spot instance for data processing, as well as how to produce visualisations of the same dataset. You’ll also need to <a href="http://scikit-learn.org/stable/install.html">install scikit-learn</a> on the machine you’re using.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-3451-1fob9te"></a>Loading and Balancing the Data</h2>
<p>To load the data from disk into memory, run the following code. You’ll need to have downloaded the Yelp dataset and untarred it in order to read the Yelp Review’s JSON file.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfe7f087925373" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">import json

# read the data from disk and split into lines
# we use .strip() to remove the final (empty) line
with open("yelp_academic_dataset_review.json") as f:
reviews = f.read().strip().split("\n")

# each line of the file is a separate JSON object
reviews = [json.loads(review) for review in reviews] 

# we're interested in the text of each review 
# and the stars rating, so we load these into 
# separate lists
texts = [review['text'] for review in reviews]
stars = [review['stars'] for review in reviews]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe7f087925373-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe7f087925373-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe7f087925373-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe7f087925373-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe7f087925373-10">10</div><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe7f087925373-12">12</div><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe7f087925373-14">14</div><div class="crayon-num" data-line="crayon-5a8af68bcfe7f087925373-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">json</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe7f087925373-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-3"><span class="crayon-c"># read the data from disk and split into lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe7f087925373-4"><span class="crayon-c"># we use .strip() to remove the final (empty) line</span></div><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-5"><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-s">"yelp_academic_dataset_review.json"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe7f087925373-6"><span class="crayon-v">reviews</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe7f087925373-8"><span class="crayon-c"># each line of the file is a separate JSON object</span></div><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-9"><span class="crayon-v">reviews</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">json</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-v">review</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">review </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">reviews</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe7f087925373-10">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-11"><span class="crayon-c"># we're interested in the text of each review </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe7f087925373-12"><span class="crayon-c"># and the stars rating, so we load these into </span></div><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-13"><span class="crayon-c"># separate lists</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe7f087925373-14"><span class="crayon-v">texts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">review</span><span class="crayon-sy">[</span><span class="crayon-s">'text'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">review </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">reviews</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfe7f087925373-15"><span class="crayon-v">stars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">review</span><span class="crayon-sy">[</span><span class="crayon-s">'stars'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">review </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">reviews</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>Even on a fast machine, this code could take a couple of minutes to run.</p>
<p>We now have two arrays of data: the text of each review and the respective star-rating. Our task is to train a system that can predict the star-rating from looking at only the review text. This is a difficult task since different people have different standards, and as a result, two different people may write a similar review with different star ratings. For example, user Bob might write “Had an OK time. Nothing to complain about” and award 4 stars, while user Tom could write the same review and award 5 stars. This makes it difficult for our system to accurately predict the rating from the text alone.</p>
<p>Another complication is that our dataset is unbalanced. We have more examples of texts that typically have a 5-star rating than texts that typically have a 2-star rating. Because of the probabilistic models at the base of most machine learning classifiers, we’ll get less biased predictions if we train the system on balanced data. This means that ideally we should have the same number of examples of each review type.</p>
<p>In machine learning, it’s common to separate our data into features and labels. In our case, the review texts (the input data) will be converted into features and the star ratings (what we are trying to predict) are the labels. You’ll often see these two categories referred to as X and Y respectively. Adding the following method to a cell will allow us to balance a dataset by removing over-represented samples from the two lists.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfe8d018857297" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from collections import Counter

def balance_classes(xs, ys):
"""Undersample xs, ys to balance classes."""
freqs = Counter(ys)

# the least common class is the maximum number we want for all classes
max_allowable = freqs.most_common()[-1][1]
num_added = {clss: 0 for clss in freqs.keys()}
new_ys = []
new_xs = []
for i, y in enumerate(ys):
if num_added[y] &lt; max_allowable:
new_ys.append(y)
new_xs.append(xs[i])
num_added[y] += 1
return new_xs, new_ys</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-10">10</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-12">12</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-14">14</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe8d018857297-16">16</div><div class="crayon-num" data-line="crayon-5a8af68bcfe8d018857297-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">collections</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-3"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">balance_classes</span><span class="crayon-sy">(</span><span class="crayon-v">xs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ys</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-4"><span class="crayon-s">"""Undersample xs, ys to balance classes."""</span></div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-5"><span class="crayon-v">freqs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">ys</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-6">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-7"><span class="crayon-c"># the least common class is the maximum number we want for all classes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-8"><span class="crayon-v">max_allowable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">freqs</span><span class="crayon-sy">.</span><span class="crayon-e">most_common</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-9"><span class="crayon-v">num_added</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">clss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">clss </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">freqs</span><span class="crayon-sy">.</span><span class="crayon-e">keys</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-10"><span class="crayon-v">new_ys</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-11"><span class="crayon-v">new_xs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-12"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">ys</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-13"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">num_added</span><span class="crayon-sy">[</span><span class="crayon-v">y</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">max_allowable</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-14"><span class="crayon-v">new_ys</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-15"><span class="crayon-v">new_xs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">xs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe8d018857297-16"><span class="crayon-v">num_added</span><span class="crayon-sy">[</span><span class="crayon-v">y</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5a8af68bcfe8d018857297-17"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">new_xs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">new_ys</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0040 seconds] -->
<p></p>
<p>Now we can create a balanced dataset of reviews and stars by running the following code (remember that now our texts are x and the stars are y).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfe94312594872" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">print(Counter(stars))
balanced_x, balanced_y = balance_classes(texts, stars)
print(Counter(balanced_y))

&gt;&gt;&gt;Counter({5: 1704200, 4: 1032654, 1: 540377, 3: 517369, 2: 358550})
&gt;&gt;&gt;Counter({1: 358550, 2: 358550, 3: 358550, 4: 358550, 5: 358550})</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfe94312594872-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe94312594872-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfe94312594872-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe94312594872-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfe94312594872-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfe94312594872-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfe94312594872-1"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">stars</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe94312594872-2"><span class="crayon-v">balanced_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">balanced_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">balance_classes</span><span class="crayon-sy">(</span><span class="crayon-v">texts</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stars</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfe94312594872-3"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe94312594872-4">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfe94312594872-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-cn">5</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1704200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1032654</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">540377</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">517369</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">358550</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfe94312594872-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">358550</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">358550</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">358550</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">358550</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">358550</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<p>You can see above that in the original distribution, we had 358,550 2-star reviews and 1.7 million 5-star reviews. After balancing, we have 358,550 of each class of review. We’re now ready to prepare our data for classification.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-3451-3znysh7"></a>Vectorizing our Text Data</h2>
<p>Computers deal with numbers much better than they do with text, so we need a meaningful way to convert all the text data into matrices of numbers. A straightforward (and oft-used) method for doing this is to count how often words appear in a piece of text and represent each text with an array of word-frequencies. Therefore the short text of the dog jumps over the dog could be represented by the following array:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfe9f519436298" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">[2, 0, 0, 0, ..., 1, 0, 0, 0, ..., 2, 0, 0, 0, ..., 1, 0, 0, 0, ...]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfe9f519436298-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfe9f519436298-1"><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>The array would be quite large, containing one element for every possible word. We would store a lookup table separately, recording that (for example) the 0th element of each array represents the word “dog”. Because the word dog occurs twice in our text, we have a 2 in this position. Most of the words do not appear in our text, so most elements would contain 0. We also have a 1 to represent jumps, another 1 for over and another 2 for the.</p>
<p>A slightly more sophisticated approach would be to use Term Frequency Inverse Document Frequency (TF-IDF) vectors. This approach comes from the idea that common words, such as the aren’t very important, while less common words such as Namibia are more important. TF-IDF therefore normalises the count of each word in each text by the number of times that that word occurs in all of the texts. If a word occurs in nearly all of the texts, we deem it to be less significant. If it only appears in several texts, we regard it as more important.</p>
<p>The last thing that you need to know about text representation is the concept of n-grams. Words often mean very different things when we combine them in different ways. We will expect our learning algorithm to learn that a review containing the words bad is likely to be negative, while one containing the word great is likely to be positive. However, reviews containing phrases such as “… and then they gave us a full refund. Not bad!” or “The food was not great” will trip up our system if it only considers words individually.</p>
<p>When we break a text into n-grams, we consider several words grouped together to be a single word. “The food was not great” would be represented using bi-grams as (the food, food was, was not, not great), and this would allow our system to learn that not great is a typically negative statement because it appears in many negative reviews.</p>
<p>Using progressively longer combinations of words allows our system to learn fine-grained meanings, but at the cost of processing power and data-scarcity (there are many three-word phrases that might only appear once, and therefore are not much good for learning general rules). For our analysis, we’ll stick with single words (also called unigrams) and bigrams (two words at a time).</p>
<p>Luckily scikit-learn implements all of this for us: the TF-IDF algorithm along with n-grams and tokenization (splitting the text into individual words). To turn all of our reviews into vectors, run the following code (which took roughly 12 minutes to complete on an r4.4xlarge EC2 instance):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfea8718130101" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.feature_extraction.text import TfidfVectorizer

# This vectorizer breaks text into single words and bi-grams
# and then calculates the TF-IDF representation
vectorizer = TfidfVectorizer(ngram_range=(1,2))
t1 = datetime.now()

# the 'fit' builds up the vocabulary from all the reviews
# while the 'transform' step turns each indivdual text into
# a matrix of numbers.
vectors = vectorizer.fit_transform(balanced_x)
print(datetime.now() - t1)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfea8718130101-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfea8718130101-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfea8718130101-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfea8718130101-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfea8718130101-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfea8718130101-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfea8718130101-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfea8718130101-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfea8718130101-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfea8718130101-10">10</div><div class="crayon-num" data-line="crayon-5a8af68bcfea8718130101-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfea8718130101-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfea8718130101-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-v">feature_extraction</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">TfidfVectorizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfea8718130101-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfea8718130101-3"><span class="crayon-c"># This vectorizer breaks text into single words and bi-grams</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfea8718130101-4"><span class="crayon-c"># and then calculates the TF-IDF representation</span></div><div class="crayon-line" id="crayon-5a8af68bcfea8718130101-5"><span class="crayon-v">vectorizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TfidfVectorizer</span><span class="crayon-sy">(</span><span class="crayon-v">ngram_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfea8718130101-6"><span class="crayon-v">t1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfea8718130101-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfea8718130101-8"><span class="crayon-c"># the 'fit' builds up the vocabulary from all the reviews</span></div><div class="crayon-line" id="crayon-5a8af68bcfea8718130101-9"><span class="crayon-c"># while the 'transform' step turns each indivdual text into</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfea8718130101-10"><span class="crayon-c"># a matrix of numbers.</span></div><div class="crayon-line" id="crayon-5a8af68bcfea8718130101-11"><span class="crayon-v">vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfea8718130101-12"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">t1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p></p>
<h2 data-fontsize="26" data-lineheight="39">Creating a Train/Test Split</h2>
<p>You can find patterns anywhere in any random noise, such as finding shapes in clouds. Machine learning algorithms are all about finding patterns, and they often find patterns that aren’t meaningful to us. In order to prove that the system is actually learning what we think it is, we’ll “train” it on one part of our data and then get it to predict the labels (star ratings) on an part of the data it didn’t see during training. If it does this with high accuracy (if it can predict the ratings of reviews it hasn’t seen during the training phase), then we’ll know the system has learned some general principles rather than just memorizing results for each specific review.</p>
<p>We had two arrays of data–the reviews and the ratings. Now we’ll want four arrays–features and labels for training and the same for testing. There is a train_test_split function in scikit-learn that does exactly this. Run the following code in a new cell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfeae535141548" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(vectors, balanced_y, test_size=0.33, random_state=42)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfeae535141548-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeae535141548-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfeae535141548-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeae535141548-2"><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">vectors</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">balanced_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_size</span><span class="crayon-o">=</span><span class="crayon-cn">0.33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>We now have a third of our data in X_test and y_test. We’ll teach our system using two-thirds of the data (X_train and y_train), and then see how well it does by comparing its predictions for the reviews in X_test with the real ratings in y_test.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-3451-tyjcwt"></a>Fitting a Classifier and Making Predictions</h2>
<p>The classifier we’ll use is a Linear Support Vector Machine (SVM), which has been shown to perform well on several text classifications tasks. We’ll skip over the mathematics and theory behind SVMs, but essentially the SVM will try to find a way to separate the different classes of our data. Remember that we have vectorized our text, so each review is now represented as a set of coordinates in a high-dimensional space. During training, the SVM will try to find some hyperplanes that separate our training examples. When we feed it the test data (minus the matching labels), it will use the boundaries it learned during training to predict the rating of each test review. You can find a more in-depth overview of SVMs <a href="https://en.wikipedia.org/wiki/Support_vector_machine">in Wikipedia</a>.</p>
<p>To create a Linear SVM using scikit-learn, we need to import LinearSVC and call .fit() on it, passing in our training instances and labels (X_train and y_train). Add the following code to a new cell and run it:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfeb4085113527" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.svm import LinearSVC

# initialise the SVM classifier
classifier = LinearSVC()

# train the classifier
t1 = datetime.now()
classifier.fit(X_train, y_train)
print(datetime.now() - t1)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfeb4085113527-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeb4085113527-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfeb4085113527-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeb4085113527-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfeb4085113527-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeb4085113527-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfeb4085113527-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeb4085113527-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfeb4085113527-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfeb4085113527-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">LinearSVC</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeb4085113527-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfeb4085113527-3"><span class="crayon-c"># initialise the SVM classifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeb4085113527-4"><span class="crayon-v">classifier</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearSVC</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfeb4085113527-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeb4085113527-6"><span class="crayon-c"># train the classifier</span></div><div class="crayon-line" id="crayon-5a8af68bcfeb4085113527-7"><span class="crayon-v">t1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeb4085113527-8"><span class="crayon-v">classifier</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfeb4085113527-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">t1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Fitting the classifier is faster than vectorizing the text (~ 6 minutes on an r4.4xlarge instance). Once the classifier has been fitted, it can be used to make predictions. Let’s start by predicting the rating for the first ten reviews in our test set (remember that the classifier has never seen these reviews before). Run the following code in a new cell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfeba396191812" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">preds = classifier.predict(X_test)
print(list(preds[:10]))
print(y_test[:10])

&gt;&gt;&gt;[4, 1, 1, 2, 5, 4, 1, 5, 5, 1]
&gt;&gt;&gt;[5, 1, 1, 3, 5, 4, 1, 5, 5, 2]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfeba396191812-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeba396191812-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfeba396191812-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeba396191812-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfeba396191812-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfeba396191812-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfeba396191812-1"><span class="crayon-v">preds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">classifier</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeba396191812-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">preds</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfeba396191812-3"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeba396191812-4">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfeba396191812-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfeba396191812-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>(Note that the classifier is fast once it has been trained so it should only take a couple of seconds to generate predictions for the entire test set.)</p>
<p>The first line of the output displays the ratings our classifier predicted for the first ten reviews in our dataset, and the second line shows the actual ratings of the same reviews. It’s not perfect, but the predictions are quite good. For example, the first review in our data set is a 5-star review, and our classifier thought it was a 4-star review. The classifier predicted that the fifth review in our dataset was a 5-star review, which was correct. We can take a quick look at each of these reviews manually. Run the following code in a new cell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfec0429673539" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">print(texts[0])
print(texts[4])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfec0429673539-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfec0429673539-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfec0429673539-1"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">texts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfec0429673539-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">texts</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>&gt;&gt;&gt; If you enjoy service by someone who is as competent as he is personable, I would recommend Corey Kaplan highly. The time he has spent here has been very productive and working with him educational and enjoyable. I hope not to need him again (though this is highly unlikely) but knowing he is there if I do is very nice. By the way, I’m not from El Centro, CA. but Scottsdale, AZ.<br>
&gt;&gt;&gt; I walked in here looking for a specific piece of furniture. I didn’t find it, but what I did find were so many things that I didn’t even know I needed! So much cool stuff here, go check it out!</p>
<p>We can see that although the reviewer of the first reviewer did leave 5-stars, he uses more moderate descriptions and his review contains some neutral phrases such as “By the way, I’m not from El Centro”, while the phrases used in the fifth review are more extremely positive (“Cool stuff”). It’s clear that the prediction task would be difficult for a human as well!</p>
<p>Looking at the results of ten predictions is a nice sanity-check and can help us build our own intuitions about what the system is doing. We’ll want to see how it performs over a larger set before deciding how well it can perform the prediction task.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-3451-3dy6vkm"></a>Evaluating our Classifier</h2>
<p>There are a number of metrics that we can use to estimate the quality of our classifier. The simplest method for evaluating such a system is to see the percentage of the time it accurately predicts the desired answer. This method is unsurprisingly called accuracy. We can calculate the accuracy of our system by comparing the predicted reviews and the real reviews–when they are the same, our classifier predicted the review correctly. We sum up all of the correct answers and divide by the total number of reviews in our test set. If this number is equal to 1, it means our classifier was spot on every time. A score of 0.5 means half of its answers were correct. You can ask scikit-learn to calculate the accuracy as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfec7726729789" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.metrics import accuracy_score
print(accuracy_score(y_test, preds))

&gt;&gt;&gt;0.62361732769</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfec7726729789-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfec7726729789-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfec7726729789-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfec7726729789-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfec7726729789-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfec7726729789-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfec7726729789-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfec7726729789-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-cn">0.62361732769</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>The score may seem a bit low, since the classifier was only correct about 62% of the time, but keep in mind that with five rating classes, random guessing would be correct only 20% of the time.</p>
<p>Accuracy is a crude metric–there are of course finer-grained evaluation methods. It’s likely that some classes are ‘easier’ to predict than others, so we want to look at how well the classifier can predict each class (for example, only 5-star reviews) individually. Looking at results on a per-class level means that there are two different ways that the classifier could be wrong. For a given review and a given class, the classifier might have a false positive or a false negative classification. If we take 5-star reviews as an example, a false positive occurs when the classifier predicted that a review was a 5-star review when in fact it wasn’t. A false negative occurs when the classifier predicted a review wasn’t a 5-star review, when in fact it was.</p>
<p>Building on the ideas of false-positives and false-negatives, we introduce precision and recall. A classifier that could predict 5-star reviews with high precision would almost never predict that other reviews were 5-star reviews, but it might ‘miss’ many real 5-star reviews and classify them into other classes. A classifier with high recall for 5-star reviews would hardly ever predict that a 5-star review was something else, but it might predict that many other reviews are 5-star reviews. Precision and recall can be a bit confusing at first–there is a <a href="https://en.wikipedia.org/wiki/Precision_and_recall">nice Wikipedia article</a> that explains these topic in more detail.</p>
<p>We would like our classifier to strike a balance between precision and recall for all of the classes, and we can measure both at the same time using an F1 Score, which measures both precision and recall as a single metric. We can get an overview of all the classes by using the classification_report from scikit-learn. Run the following code in a new cell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfece479294395" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.metrics import classification_report
print(classification_report(y_test, preds))

&gt;&gt;&gt;
precision recall f1-score support

1 0.72 0.79 0.75 118238
2 0.56 0.52 0.54 118438
3 0.54 0.51 0.53 118370
4 0.55 0.54 0.54 118538
5 0.71 0.76 0.74 118024

avg / total 0.62 0.62 0.62 591608</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfece479294395-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfece479294395-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfece479294395-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfece479294395-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfece479294395-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfece479294395-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfece479294395-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfece479294395-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfece479294395-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfece479294395-10">10</div><div class="crayon-num" data-line="crayon-5a8af68bcfece479294395-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfece479294395-12">12</div><div class="crayon-num" data-line="crayon-5a8af68bcfece479294395-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfece479294395-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">classification_report</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfece479294395-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">classification_report</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfece479294395-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfece479294395-4"><span class="crayon-o">&gt;&gt;&gt;</span></div><div class="crayon-line" id="crayon-5a8af68bcfece479294395-5"><span class="crayon-e">precision </span><span class="crayon-e">recall </span><span class="crayon-v">f1</span><span class="crayon-o">-</span><span class="crayon-e">score </span><span class="crayon-i">support</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfece479294395-6">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfece479294395-7"><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0.72</span><span class="crayon-h"> </span><span class="crayon-cn">0.79</span><span class="crayon-h"> </span><span class="crayon-cn">0.75</span><span class="crayon-h"> </span><span class="crayon-cn">118238</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfece479294395-8"><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">0.56</span><span class="crayon-h"> </span><span class="crayon-cn">0.52</span><span class="crayon-h"> </span><span class="crayon-cn">0.54</span><span class="crayon-h"> </span><span class="crayon-cn">118438</span></div><div class="crayon-line" id="crayon-5a8af68bcfece479294395-9"><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-cn">0.54</span><span class="crayon-h"> </span><span class="crayon-cn">0.51</span><span class="crayon-h"> </span><span class="crayon-cn">0.53</span><span class="crayon-h"> </span><span class="crayon-cn">118370</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfece479294395-10"><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-cn">0.55</span><span class="crayon-h"> </span><span class="crayon-cn">0.54</span><span class="crayon-h"> </span><span class="crayon-cn">0.54</span><span class="crayon-h"> </span><span class="crayon-cn">118538</span></div><div class="crayon-line" id="crayon-5a8af68bcfece479294395-11"><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-cn">0.71</span><span class="crayon-h"> </span><span class="crayon-cn">0.76</span><span class="crayon-h"> </span><span class="crayon-cn">0.74</span><span class="crayon-h"> </span><span class="crayon-cn">118024</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfece479294395-12">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfece479294395-13"><span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">total</span><span class="crayon-h"> </span><span class="crayon-cn">0.62</span><span class="crayon-h"> </span><span class="crayon-cn">0.62</span><span class="crayon-h"> </span><span class="crayon-cn">0.62</span><span class="crayon-h"> </span><span class="crayon-cn">591608</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<p>We can see from the above that the 1- and 5-star reviews are the easiest to predict, and we get F1 Scores of 0.75 and 0.74 respectively for them. The neutral reviews are more difficult to predict, as evidenced by F1 scores that are just over 0.5.</p>
<p>The final evaluation metric we can consider is a confusion matrix. A confusion matrix demonstrates which predictions are most often confused. For our setup, we would hope that 1- and 5-star reviews are not confused too often by the classifier, but we don’t care too much if it mixes up 4-star and 5-star reviews.</p>
<p>We can examine the confusion matrix by running the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfed3327017166" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.metrics import confusion_matrix
print(confusion_matrix(y_test, preds))

&gt;&gt;&gt;
[[92846 20722 3075 724 871]
[27820 62166 23652 3448 1352]
[ 5478 24054 60686 23535 4617]
[ 1319 3414 21111 63503 29191]
[ 1023 763 3056 23446 89736]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfed3327017166-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfed3327017166-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfed3327017166-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfed3327017166-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfed3327017166-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfed3327017166-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfed3327017166-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfed3327017166-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfed3327017166-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfed3327017166-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">confusion_matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfed3327017166-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">confusion_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfed3327017166-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfed3327017166-4"><span class="crayon-o">&gt;&gt;&gt;</span></div><div class="crayon-line" id="crayon-5a8af68bcfed3327017166-5"><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">92846</span><span class="crayon-h"> </span><span class="crayon-cn">20722</span><span class="crayon-h"> </span><span class="crayon-cn">3075</span><span class="crayon-h"> </span><span class="crayon-cn">724</span><span class="crayon-h"> </span><span class="crayon-cn">871</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfed3327017166-6"><span class="crayon-sy">[</span><span class="crayon-cn">27820</span><span class="crayon-h"> </span><span class="crayon-cn">62166</span><span class="crayon-h"> </span><span class="crayon-cn">23652</span><span class="crayon-h"> </span><span class="crayon-cn">3448</span><span class="crayon-h"> </span><span class="crayon-cn">1352</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfed3327017166-7"><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">5478</span><span class="crayon-h"> </span><span class="crayon-cn">24054</span><span class="crayon-h"> </span><span class="crayon-cn">60686</span><span class="crayon-h"> </span><span class="crayon-cn">23535</span><span class="crayon-h"> </span><span class="crayon-cn">4617</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfed3327017166-8"><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">1319</span><span class="crayon-h"> </span><span class="crayon-cn">3414</span><span class="crayon-h"> </span><span class="crayon-cn">21111</span><span class="crayon-h"> </span><span class="crayon-cn">63503</span><span class="crayon-h"> </span><span class="crayon-cn">29191</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfed3327017166-9"><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">1023</span><span class="crayon-h"> </span><span class="crayon-cn">763</span><span class="crayon-h"> </span><span class="crayon-cn">3056</span><span class="crayon-h"> </span><span class="crayon-cn">23446</span><span class="crayon-h"> </span><span class="crayon-cn">89736</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p>The confusion matrix itself can be a bit … confusing. The rows represent the predictions we made for each kind of review, while the columns represent the correct classes. Let’s consider a few examples to see what is happening:</p>
<ul>
<li>The first row describes all of the reviews that the classifier predicted as being 1-star reviews. The top left cell means that the classifier correctly predicted 92,846 1-star reviews.</li>
<li>The cell immediately to the right (first row, second column) indicates that there were 20,722 reviews which were 1-star reviews but which our classifier thought were 2-star reviews.</li>
<li>The cell in the first column of the second row indicates that there were 27,820 2-star reviews which our classifier thought were 1-star reviews.</li>
<li>The diagonal from the top left to the bottom right represents all of the correct predictions made by our classifier. We want these numbers to be the highest.</li>
<li>The top right corner says that there were 871 5-star reviews which the classifier thought were 1-star reviews.</li>
<li>The bottom left hand corner says that there were 1,023 1-star reviews which the classifier thought were 5-star reviews.</li>
</ul>
<p>We can see that there are clusters of high numbers towards the top left and bottom right, showing that the classifier mainly confused, for example, 4- and 5-star reviews, or 1- and 2-star ones. The numbers towards the top right and bottom left are lower, showing that the classifier rarely was completely wrong (thinking that a 5-star review was actually a 1-star, or vice-versa).</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-3451-1t3h5sf"></a>Remodeling our Problem</h2>
<p>As our final task, we’ll try to model a simpler problem and run the exact same analysis. Instead of trying to predict the exact star rating, we’ll try to classify the posts into positive (4- or 5-star reviews) or negative (1- or 2-star reviews). We’ll remove all the 3-star reviews for this task.</p>
<p>We don’t need to recalculate the vectors since we’re using the same texts. We simply need to remove the instances and labels for all 3-star reviews and modify our labels (train_y and test_y). Because our (vectorized) reviews are stored in numpy arrays and our labels are stored in Python lists, we have to treat each of these separately. The code below strips out the 3-star reviews and the labels, then converts all the labels to n for negative or p for positive:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfedc398154313" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">keep = set([1,2,4,5])

# calculate the indices for the examples we want to keep
keep_train_is = [i for i, y in enumerate(y_train) if y in keep]
keep_test_is = [i for i, y in enumerate(y_test) if y in keep]

# convert the train set
X_train2 = X_train[keep_train_is, :]
y_train2 = [y_train[i] for i in keep_train_is]
y_train2 = ["n" if (y == 1 or y == 2) else "p" for y in y_train2]

# convert the test set
X_test2 = X_test[keep_test_is, :]
y_test2 = [y_test[i] for i in keep_test_is]
y_test2 = ["n" if (y == 1 or y == 2) else "p" for y in y_test2]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfedc398154313-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfedc398154313-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfedc398154313-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfedc398154313-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfedc398154313-10">10</div><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfedc398154313-12">12</div><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfedc398154313-14">14</div><div class="crayon-num" data-line="crayon-5a8af68bcfedc398154313-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-1"><span class="crayon-v">keep</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">set</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfedc398154313-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-3"><span class="crayon-c"># calculate the indices for the examples we want to keep</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfedc398154313-4"><span class="crayon-v">keep_train_is</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">keep</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-5"><span class="crayon-v">keep_test_is</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">keep</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfedc398154313-6">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-7"><span class="crayon-c"># convert the train set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfedc398154313-8"><span class="crayon-v">X_train2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">[</span><span class="crayon-v">keep_train_is</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-9"><span class="crayon-v">y_train2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">y_train</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">keep_train_is</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfedc398154313-10"><span class="crayon-v">y_train2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"n"</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-s">"p"</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">y_train2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfedc398154313-12"><span class="crayon-c"># convert the test set</span></div><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-13"><span class="crayon-v">X_test2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">[</span><span class="crayon-v">keep_test_is</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfedc398154313-14"><span class="crayon-v">y_test2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">y_test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">keep_test_is</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfedc398154313-15"><span class="crayon-v">y_test2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"n"</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-s">"p"</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">y_test2</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0060 seconds] -->
<p></p>
<p>Once we’ve set up these new arrays, we can run exactly the same “train-predict-evaluate” steps that we went through previously:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfee2379297020" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">classifier.fit(X_train2, y_train2)
preds = classifier.predict(X_test2)
print(classification_report(y_test2, preds))
print(confusion_matrix(y_test2, preds))

&gt;&gt;&gt; precision recall f1-score support

n 0.96 0.96 0.96 236676
p 0.96 0.96 0.96 236562

avg / total 0.96 0.96 0.96 473238

&gt;&gt;&gt;
[[227648 9028]
[ 9237 227325]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee2379297020-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee2379297020-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee2379297020-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee2379297020-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee2379297020-10">10</div><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee2379297020-12">12</div><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee2379297020-14">14</div><div class="crayon-num" data-line="crayon-5a8af68bcfee2379297020-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-1"><span class="crayon-v">classifier</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee2379297020-2"><span class="crayon-v">preds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">classifier</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-3"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">classification_report</span><span class="crayon-sy">(</span><span class="crayon-v">y_test2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee2379297020-4"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">confusion_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">y_test2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee2379297020-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">precision </span><span class="crayon-e">recall </span><span class="crayon-v">f1</span><span class="crayon-o">-</span><span class="crayon-e">score </span><span class="crayon-i">support</span></div><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee2379297020-8"><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">236676</span></div><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-9"><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">236562</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee2379297020-10">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-11"><span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">total</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">0.96</span><span class="crayon-h"> </span><span class="crayon-cn">473238</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee2379297020-12">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-13"><span class="crayon-o">&gt;&gt;&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee2379297020-14"><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">227648</span><span class="crayon-h"> </span><span class="crayon-cn">9028</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfee2379297020-15"><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">9237</span><span class="crayon-h"> </span><span class="crayon-cn">227325</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p></p>
<p>We can see that this task is much easier for our classifier, and it predicts the correct class 96% of the time! The confusion matrix tells us that there were 9,028 negative reviews that the classifier thought were positive and 9,237 positive reviews that the classifier thought were negative–everything else was correct.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-3451-4d34og8"></a>Conclusion</h2>
<p>This post covered the basics of using a Support Vector Machine to classify text. After vectorizing text and training a classifier, two prediction tasks were performed–predicting the exact rating of each review vs. predicting whether the review was positive or negative.</p>
<p>Why would we be interested in predicting the ratings from text–after all, we already have the correct ratings at our disposal? There are many uses for systems such as the one we just built. For example, a company might want to analyze social media in order to find out how the public feels about the company, or reach out to customers who post negative reviews of the company. Specific companies are often mentioned on Twitter, Facebook, and other social media sites, and in these situations the text descriptions are not accompanied by a star rating.</p>
<p>As a more concrete example, imagine that you’re the manager of the NotARealName Hotel, and you’re automatically gathering tweets which mention your hotel, and you want</p>
<ul>
<li>a) to know if the general sentiment regarding your hotel is going up or down over time, and</li>
<li>b) to respond to negative comments about your hotel (or share positive ones)</li>
</ul>
<p>The following code uses our same classifier on new data. We use two fictitious tweets–the first one is obviously negative and the second one positive. Can we classify them without human intervention?</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af68bcfee9224628307" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;"># only two texts as an example
texts = ["I really hated my stay at The NotARealName Hotel", "Had a really really great stay at NotARealName - would recommend to everyone"]

# note that we only call .transform() here and not .fit_transform()
# as we want to keep the vocabulary from the previous experiments
vecs = vectorizer.transform(texts)

# predict a positive or negative label for each input
print(classifier.predict(vecs))

&gt;&gt;&gt;['n' 'p']</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af68bcfee9224628307-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee9224628307-2">2</div><div class="crayon-num" data-line="crayon-5a8af68bcfee9224628307-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee9224628307-4">4</div><div class="crayon-num" data-line="crayon-5a8af68bcfee9224628307-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee9224628307-6">6</div><div class="crayon-num" data-line="crayon-5a8af68bcfee9224628307-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee9224628307-8">8</div><div class="crayon-num" data-line="crayon-5a8af68bcfee9224628307-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af68bcfee9224628307-10">10</div><div class="crayon-num" data-line="crayon-5a8af68bcfee9224628307-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af68bcfee9224628307-1"><span class="crayon-c"># only two texts as an example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee9224628307-2"><span class="crayon-v">texts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"I really hated my stay at The NotARealName Hotel"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"Had a really really great stay at NotARealName - would recommend to everyone"</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af68bcfee9224628307-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee9224628307-4"><span class="crayon-c"># note that we only call .transform() here and not .fit_transform()</span></div><div class="crayon-line" id="crayon-5a8af68bcfee9224628307-5"><span class="crayon-c"># as we want to keep the vocabulary from the previous experiments</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee9224628307-6"><span class="crayon-v">vecs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">texts</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af68bcfee9224628307-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee9224628307-8"><span class="crayon-c"># predict a positive or negative label for each input</span></div><div class="crayon-line" id="crayon-5a8af68bcfee9224628307-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">classifier</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">vecs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af68bcfee9224628307-10">&nbsp;</div><div class="crayon-line" id="crayon-5a8af68bcfee9224628307-11"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-sy">[</span><span class="crayon-s">'n'</span><span class="crayon-h"> </span><span class="crayon-s">'p'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Our classifier determines that the first tweet is negative and the second one is positive. However, we wouldn’t want to trust it too much. Remember that it’s likely to be sensitive to the kind of language that’s used in Yelp reviews, so if we want to classify text from other areas, e.g., finance or politics, we’ll likely find the results to be less satisfying. However, with enough training data, we can easily retrain the classifier on examples that better match our desired task.</p>
<div class="fusion-button-wrapper fusion-aligncenter">
<style type="text/css" scoped="scoped">.fusion-button.button-1 .fusion-button-text, .fusion-button.button-1 i {color:#ffffff;}.fusion-button.button-1 {border-width:0px;border-color:#ffffff;}.fusion-button.button-1 .fusion-button-icon-divider{border-color:#ffffff;}.fusion-button.button-1:hover .fusion-button-text, .fusion-button.button-1:hover i,.fusion-button.button-1:focus .fusion-button-text, .fusion-button.button-1:focus i,.fusion-button.button-1:active .fusion-button-text, .fusion-button.button-1:active{color:#ffffff;}.fusion-button.button-1:hover, .fusion-button.button-1:focus, .fusion-button.button-1:active{border-width:0px;border-color:#ffffff;}.fusion-button.button-1:hover .fusion-button-icon-divider, .fusion-button.button-1:hover .fusion-button-icon-divider, .fusion-button.button-1:active .fusion-button-icon-divider{border-color:#ffffff;}.fusion-button.button-1{background: #e9873d;<br />					background-image: -webkit-gradient( linear, left bottom, left top, from( #b16931 ), to( #e9873d ) );<br />					background-image: -webkit-linear-gradient( bottom, #b16931, #e9873d );<br />					background-image:   -moz-linear-gradient( bottom, #b16931, #e9873d );<br />					background-image:     -o-linear-gradient( bottom, #b16931, #e9873d );<br />					background-image: linear-gradient( to top, #b16931, #e9873d );}.fusion-button.button-1:hover,.button-1:focus,.fusion-button.button-1:active{background: #f47e24;}.fusion-button.button-1{width:auto;}</style>
<p><a class="fusion-button button-flat button-round button-xlarge button-custom button-1" href="http://www.developintelligence.com/catalog/devops/python" target="_self"><span class="fusion-button-text">Get Python Training for Teams</span></a></p>
</div>
<div id="ts-fab-below" class="ts-fab-wrapper"><span class="screen-reader-text">The following two tabs change content below.</span><ul class="ts-fab-list"><li class="ts-fab-bio-link active"><a href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/#ts-fab-bio-below">Bio</a></li><li class="ts-fab-latest-posts-link"><a href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/#ts-fab-latest-posts-below">Latest Posts</a></li></ul><div class="ts-fab-tabs">
	<div class="ts-fab-tab" id="ts-fab-bio-below" style="display: block;">
		<div class="ts-fab-avatar"><img alt="mm" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/me-150x150.jpg" class="avatar avatar-80 photo" height="80" width="80"><div class="ts-fab-social-links"></div>
		</div>
		
		<div class="ts-fab-text">
			<div class="ts-fab-header"><h4 data-fontsize="18" data-lineheight="18">Gareth Dwyer</h4></div><!-- /.ts-fab-header -->
			<div class="ts-fab-content">Gareth enjoys writing. His favourite languages are Python and English, but he's not too fussy. He is author of the book "Flask by Example", and plays around with Python, Natural Language Processing, and Machine Learning. You can follow him on Twitter as @sixhobbits.</div>
		</div>
	</div>
	<div class="ts-fab-tab" id="ts-fab-latest-posts-below" style="display: none;">
		<div class="ts-fab-avatar"><img alt="mm" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/me-150x150.jpg" class="avatar avatar-80 photo" height="80" width="80"><div class="ts-fab-social-links"></div>
		</div>
		<div class="ts-fab-text">
			<div class="ts-fab-header">
				<h4 data-fontsize="18" data-lineheight="18">Latest posts by Gareth Dwyer <span class="latest-see-all">(<a href="http://www.developintelligence.com/blog/author/gareth/" rel="nofollow">see all</a>)</span></h4>
			</div>
			<ul class="ts-fab-latest">
				<li>
					<a href="http://www.developintelligence.com/blog/2017/08/building-serverless-chatbot-aws-zappa-telegram-api-ai/">Building a Serverless Chatbot w/ AWS, Zappa, Telegram, and api.ai</a><span> - August 2, 2017</span> 
				</li>
				<li>
					<a href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/">Practical Neural Networks with Keras: Classifying Yelp Reviews</a><span> - June 1, 2017</span> 
				</li>
				<li>
					<a href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/">Predicting Yelp Stars from Reviews with scikit-learn and Python</a><span> - March 14, 2017</span> 
				</li>
		</ul></div>
	</div>
		</div>
	</div><!-- Facebook Comments Plugin for WordPress: http://peadig.com/wordpress-plugins/facebook-comments/ --><h3 data-fontsize="22" data-lineheight="33">Comments</h3><p><fb:comments-count href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/" fb-xfbml-state="rendered" class=" fb_comments_count_zero"><span class="fb_comments_count">0</span></fb:comments-count> comments</p><div class="fb-comments fb_iframe_widget fb_iframe_widget_fluid" data-href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/" data-numposts="50" data-width="100%" data-colorscheme="light" fb-xfbml-state="rendered"><span style="height: 176px;"><iframe id="f3767f31fa986f8" name="f12a4c5440b653c" scrolling="no" title="Facebook Social Plugin" class="fb_ltr" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/comments.html" style="border: none; overflow: hidden; height: 176px; width: 100%;"></iframe></span></div>							</div>
						<div class="fusion-sharing-box fusion-single-sharing-box share-box">
				<h4 data-fontsize="18" data-lineheight="27">Share This Article</h4>
				<div class="fusion-social-networks boxed-icons"><div class="fusion-social-networks-wrapper"><a class="fusion-social-network-icon fusion-tooltip fusion-facebook fusion-icon-facebook" style="color:#ffffff;background-color:#3b5998;border-color:#3b5998;border-radius:4px;" href="http://www.facebook.com/sharer.php?m2w&amp;s=100&amp;p[url]=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/&amp;p[images][0]=http://www.developintelligence.com/blog/wp-content/uploads/2017/03/Creating-Persistent-9.png&amp;p[title]=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Facebook" data-toggle="tooltip" title="" data-original-title="Facebook"><span class="screen-reader-text">Facebook</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-twitter fusion-icon-twitter" style="color:#ffffff;background-color:#55acee;border-color:#55acee;border-radius:4px;" href="https://twitter.com/share?text=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python&amp;url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F03%2Fpredicting-yelp-star-ratings-review-text-python%2F" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Twitter" data-toggle="tooltip" title="" data-original-title="Twitter"><span class="screen-reader-text">Twitter</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-linkedin fusion-icon-linkedin" style="color:#ffffff;background-color:#0077b5;border-color:#0077b5;border-radius:4px;" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/&amp;title=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python&amp;summary=In%20this%20post%2C%20we%26%2339%3Bll%20look%20at%20reviews%20from%20the%20Yelp%20Dataset%20Challenge.%20We%26%2339%3Bll%20train%20a%20machine%20learning%20system%20to%20predict%20the%20star-rating%20of%20a%20review%20based%20only%20on%20its%20text.%20For%20example%2C%20if%20the%20text%20says%20%26quot%3BEverything%20was%20great%21%20Best%20stay%20ever%21%21%26quot%3B%20we%20would%20expect%20a%205-star%20rating.%20If%20the%20text%20says%20%26quot%3BWorst%20stay%20of" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Linkedin" data-toggle="tooltip" title="" data-original-title="Linkedin"><span class="screen-reader-text">Linkedin</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-reddit fusion-icon-reddit" style="color:#ffffff;background-color:#ff4500;border-color:#ff4500;border-radius:4px;" href="http://reddit.com/submit?url=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/&amp;title=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Reddit" data-toggle="tooltip" title="" data-original-title="Reddit"><span class="screen-reader-text">Reddit</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-googleplus fusion-icon-googleplus" style="color:#ffffff;background-color:#dc4e41;border-color:#dc4e41;border-radius:4px;" href="https://plus.google.com/share?url=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/" onclick="javascript:window.open(this.href,&#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Google+" data-toggle="tooltip" title="" data-original-title="Google+"><span class="screen-reader-text">Google+</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-pinterest fusion-icon-pinterest" style="color:#ffffff;background-color:#bd081c;border-color:#bd081c;border-radius:4px;" href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F03%2Fpredicting-yelp-star-ratings-review-text-python%2F&amp;description=In%20this%20post%2C%20we%26%2339%3Bll%20look%20at%20reviews%20from%20the%20Yelp%20Dataset%20Challenge.%20We%26%2339%3Bll%20train%20a%20machine%20learning%20system%20to%20predict%20the%20star-rating%20of%20a%20review%20based%20only%20on%20its%20text.%20For%20example%2C%20if%20the%20text%20says%20%26quot%3BEverything%20was%20great%21%20Best%20stay%20ever%21%21%26quot%3B%20we%20would%20expect%20a%205-star%20rating.%20If%20the%20text%20says%20%26quot%3BWorst%20stay%20of&amp;media=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2Fwp-content%2Fuploads%2F2017%2F03%2FCreating-Persistent-9.png" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Pinterest" data-toggle="tooltip" title="" data-original-title="Pinterest"><span class="screen-reader-text">Pinterest</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-mail fusion-icon-mail fusion-last-social-icon" style="color:#ffffff;background-color:#000000;border-color:#000000;border-radius:4px;" href="mailto:?subject=Predicting%20Yelp%20Stars%20from%20Reviews%20with%20scikit-learn%20and%20Python&amp;body=http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/" target="_self" rel="noopener noreferrer" data-placement="top" data-title="Email" data-toggle="tooltip" title="" data-original-title="Email"><span class="screen-reader-text">Email</span></a><div class="fusion-clearfix"></div></div></div>			</div>
			
							<div class="fusion-meta-info"><div class="fusion-meta-info-wrapper">
	
			<span class="vcard" style="display: none;">
			<span class="fn">
				<a href="http://www.developintelligence.com/blog/author/gareth/" title="Posts by Gareth Dwyer" rel="author">Gareth Dwyer</a>			</span>
		</span>
	
	

	
	
			<span class="updated" style="display:none;">
			2017-04-08T02:12:39+00:00		</span>
	
<span>March 14th, 2017</span><span class="fusion-inline-sep">|</span><a href="http://www.developintelligence.com/blog/category/big-data/" rel="category tag">Big Data</a>, <a href="http://www.developintelligence.com/blog/category/python/" rel="category tag">Python</a><span class="fusion-inline-sep">|</span></div></div>								
									</article>
		</div>
<div id="sidebar" class="sidebar fusion-widget-area fusion-content-widget-area" style="float: right;">
						
			<div id="text-4" class="widget widget_text">			<div class="textwidget"><div style="background: #e8e8e8;">

<h3 style="text-align: center; margin: 0; padding: 10px; background: #233345;" data-fontsize="22" data-lineheight="33"><a style="color: #fff;" href="tel:8776295631">(877) 629-5631</a></h3>

<div id="landing-form">
<h2 style="text-align: center; font-size: 1.25em; line-height: 125%; padding-top: 15px;" data-inline-fontsize="true" data-inline-lineheight="true" data-fontsize="20" data-lineheight="25">Get My Custom Training Consultation</h2>

                <div class="gf_browser_chrome gform_wrapper webform-client-form_wrapper" id="gform_wrapper_2"><form method="post" enctype="multipart/form-data" id="gform_2" class="webform-client-form" action="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/">
                        <div class="gform_body"><ul id="gform_fields_2" class="gform_fields top_label form_sublabel_below description_above"><li id="field_2_25" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_25">First Name</label><div class="ginput_container ginput_container_text"><input name="input_25" id="input_2_25" type="text" value="" class="large" tabindex="1" placeholder="First Name" aria-invalid="false"></div></li><li id="field_2_24" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_24">Last Name</label><div class="ginput_container ginput_container_text"><input name="input_24" id="input_2_24" type="text" value="" class="large" tabindex="2" placeholder="Last Name" aria-invalid="false"></div></li><li id="field_2_7" class="gfield gfield_contains_required field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_7">Email<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_email">
                            <input name="input_7" id="input_2_7" type="text" value="" class="large" tabindex="3" placeholder="Email" aria-required="true" aria-invalid="false">
                        </div></li><li id="field_2_27" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_27">Phone (optional)</label><div class="ginput_container ginput_container_phone"><input name="input_27" id="input_2_27" type="text" value="" class="large" tabindex="4" placeholder="Phone (optional)" aria-invalid="false"></div></li><li id="field_2_3" class="gfield gfield_contains_required field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_3">Company/Organization<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_text"><input name="input_3" id="input_2_3" type="text" value="" class="large" tabindex="5" placeholder="Company / Organization" aria-required="true" aria-invalid="false"></div></li><li id="field_2_6" class="gfield gfield_contains_required field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_6">Message<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_textarea"><textarea name="input_6" id="input_2_6" class="textarea small" tabindex="6" placeholder="How can we help?" aria-required="true" aria-invalid="false" rows="10" cols="50"></textarea></div></li><li id="field_2_29" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_29">CAPTCHA</label><div class="gfield_description">Please enter:</div><div class="gfield_captcha_container"><img class="gfield_captcha" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/953136702.png" alt="" width="150" height="42"><div class="gfield_captcha_input_container simple_captcha_medium"><input type="text" name="input_29" id="input_2_29" tabindex="7"><input type="hidden" name="input_captcha_prefix_29" value="953136702"></div></div></li><li id="field_2_28" class="gfield gform_hidden field_sublabel_below field_description_above gfield_visibility_visible"><input name="input_28" id="input_2_28" type="hidden" class="gform_hidden" aria-invalid="false" value=""></li><li id="field_2_14" class="gfield gform_hidden field_sublabel_below field_description_above gfield_visibility_visible"><input name="input_14" id="input_2_14" type="hidden" class="gform_hidden" aria-invalid="false" value="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/https://www.google.com/"></li><li id="field_2_26" class="gfield gform_hidden field_sublabel_below field_description_above gfield_visibility_visible"><input name="input_26" id="input_2_26" type="hidden" class="gform_hidden" aria-invalid="false" value="Web Lead - Blog"></li><li id="field_2_30" class="gfield gform_validation_container field_sublabel_below field_description_above gfield_visibility_"><label class="gfield_label" for="input_2_30">Email</label><div class="gfield_description">This field is for validation purposes and should be left unchanged.</div><div class="ginput_container"><input name="input_30" id="input_2_30" type="text" value=""></div></li>
                            </ul></div>
        <div class="gform_footer top_label"> <input type="submit" id="gform_submit_button_2" class="gform_button button" value="Submit" tabindex="8" onclick="if(window[&quot;gf_submitting_2&quot;]){return false;}  window[&quot;gf_submitting_2&quot;]=true;  " onkeypress="if( event.keyCode == 13 ){ if(window[&quot;gf_submitting_2&quot;]){return false;} window[&quot;gf_submitting_2&quot;]=true;  jQuery(&quot;#gform_2&quot;).trigger(&quot;submit&quot;,[true]); }"><!-- Begin Daddy Analytics fields --><input type="hidden" name="" value=""><input type="hidden" name="" value=""><!-- End Daddy Analytics fields --> 
            <input type="hidden" class="gform_hidden" name="is_submit_2" value="1">
            <input type="hidden" class="gform_hidden" name="gform_submit" value="2">
            
            <input type="hidden" class="gform_hidden" name="gform_unique_id" value="">
            <input type="hidden" class="gform_hidden" name="state_2" value="WyJbXSIsImYyNmMzNGQzYjI3MTg3NzBkYmU3MTA4OTM5ZjA2M2RlIl0=">
            <input type="hidden" class="gform_hidden" name="gform_target_page_number_2" id="gform_target_page_number_2" value="0">
            <input type="hidden" class="gform_hidden" name="gform_source_page_number_2" id="gform_source_page_number_2" value="1">
            <input type="hidden" name="gform_field_values" value="">
            
        </div>
                        </form>
                        </div><script type="text/javascript"> jQuery(document).bind('gform_post_render', function(event, formId, currentPage){if(formId == 2) {if(typeof Placeholders != 'undefined'){
                        Placeholders.enable();
                    }if(!/(android)/i.test(navigator.userAgent)){jQuery('#input_2_27').mask('(999) 999-9999').bind('keypress', function(e){if(e.which == 13){jQuery(this).blur();} } );}} } );jQuery(document).bind('gform_post_conditional_logic', function(event, formId, fields, isInit){} );</script><script type="text/javascript"> jQuery(document).ready(function(){jQuery(document).trigger('gform_post_render', [2, 1]) } ); </script>
</div>

</div></div>
		</div><div id="text-5" class="widget widget_text">			<div class="textwidget"><div style="background: #e8e8e8;margin-bottom: 30px;">
	<div style="padding-top: 15px;">
    	        <div style="padding: 0 20px 20px 15px;
line-height: 170%;
    font-size: 14px;
    color: #666666;
    overflow: hidden;
    font-family: Source Sans Pro,Arial,sans-serif;
">
            <p style="
    padding-bottom: 10px;
    line-height: 150%;
    font-size: 15px;
"><span style="color: #f48035 !important;">
DevelopIntelligence</span> has been in the technical/software development learning and training industry for nearly 20 years. We’ve provided learning solutions to more than 48,000 engineers, across 220 organizations worldwide. </p>
<img src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/about-di.png" alt="About Develop Intelligence" style="
    display: inline;
    margin-right: 15px;
    float: left;
    text-align: left;
">        </div>
    </div>
</div></div>
		</div>	</div>

				</div>  <!-- fusion-row -->
			</div>  <!-- #main -->
			
			
			
			
										
				<div class="fusion-footer">

																
						<footer class="fusion-footer-widget-area fusion-widget-area">
							<div class="fusion-row">
								<div class="fusion-columns fusion-columns-4 fusion-widget-area">
									
																																							<div class="fusion-column col-lg-3 col-md-3 col-sm-3">
												<div id="nav_menu-2" class="fusion-footer-widget-column widget widget_nav_menu"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">About Us</h4><div class="menu-footer-menu-1-container"><ul id="menu-footer-menu-1" class="menu"><li id="menu-item-6836" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6836"><a href="http://www.developintelligence.com/why-choose-developintelligence/testimonials">Testimonials</a></li>
<li id="menu-item-6837" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-6837"><a href="http://www.developintelligence.com/blog">Be Smart Blog</a></li>
<li id="menu-item-6838" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6838"><a href="http://www.developintelligence.com/why-choose-developintelligence/partners">Partners</a></li>
<li id="menu-item-6839" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6839"><a href="http://www.developintelligence.com/why-choose-developintelligence/giving-back">Giving Back</a></li>
<li id="menu-item-6840" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6840"><a href="http://www.developintelligence.com/we-are-hiring">Join The Team</a></li>
<li id="menu-item-6841" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6841"><a href="http://www.developintelligence.com/why-choose-developintelligence/in-the-news">In the News</a></li>
<li id="menu-item-6842" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6842"><a href="http://www.developintelligence.com/blog/2017-developer-learning-survey-report-free-report/">2017 Developer Report</a></li>
<li id="menu-item-6843" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6843"><a href="http://www.developintelligence.com/learn/tutorials">Tutorials</a></li>
</ul></div><div style="clear:both;"></div></div>																																				</div>
																																								<div class="fusion-column col-lg-3 col-md-3 col-sm-3">
												<div id="nav_menu-3" class="fusion-footer-widget-column widget widget_nav_menu"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">Training Options</h4><div class="menu-footer-menu-2-container"><ul id="menu-footer-menu-2" class="menu"><li id="menu-item-6826" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6826"><a href="http://www.developintelligence.com/catalog/type/hands-on">Hands-On Training Courses</a></li>
<li id="menu-item-6827" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6827"><a href="http://www.developintelligence.com/catalog/type/boot-camp">Bootcamp Courses</a></li>
<li id="menu-item-6828" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6828"><a href="http://www.developintelligence.com/catalog/type/workshop">Learn to Code Workshops</a></li>
<li id="menu-item-6829" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6829"><a href="http://www.developintelligence.com/solutions/teams/mentored-prototype-development">Expert-Led Prototyping</a></li>
<li id="menu-item-6844" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6844"><a href="http://www.developintelligence.com/catalog/skill">Courses by Skill Level</a></li>
<li id="menu-item-6845" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6845"><a href="http://www.developintelligence.com/catalog/role">Courses by Role</a></li>
</ul></div><div style="clear:both;"></div></div>																																				</div>
																																								<div class="fusion-column col-lg-3 col-md-3 col-sm-3">
												<div id="nav_menu-4" class="fusion-footer-widget-column widget widget_nav_menu"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">Courses by Category</h4><div class="menu-footer-menu-3-container"><ul id="menu-footer-menu-3" class="menu"><li id="menu-item-6830" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6830"><a href="http://www.developintelligence.com/catalog/it-training">All Courses (IT Training)</a></li>
<li id="menu-item-6831" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6831"><a href="http://www.developintelligence.com/catalog/agile-training">Agile Training</a></li>
<li id="menu-item-6832" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6832"><a href="http://www.developintelligence.com/catalog/apache-training">Apache Training</a></li>
<li id="menu-item-6846" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6846"><a href="http://www.developintelligence.com/catalog/google-training">Google Training</a></li>
<li id="menu-item-6847" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6847"><a href="http://www.developintelligence.com/catalog/j2ee-training-java-ee-training">Java EE Training</a></li>
<li id="menu-item-6848" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6848"><a href="http://www.developintelligence.com/catalog/javascript-training">JavaScript Training</a></li>
<li id="menu-item-6849" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6849"><a href="http://www.developintelligence.com/catalog/jboss-training">JBoss Training</a></li>
<li id="menu-item-6850" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6850"><a href="http://www.developintelligence.com/catalog/mysql-training">MySQL Training</a></li>
<li id="menu-item-6851" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6851"><a href="http://www.developintelligence.com/catalog/ruby-training">Ruby Training</a></li>
<li id="menu-item-6852" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6852"><a href="http://www.developintelligence.com/catalog/open-source-training/scala">Scala Training</a></li>
<li id="menu-item-6853" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6853"><a href="http://www.developintelligence.com/catalog/spring-source-training">SpringSource Training</a></li>
<li id="menu-item-6854" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6854"><a href="http://www.developintelligence.com/catalog/zend-training">Zend Training</a></li>
</ul></div><div style="clear:both;"></div></div>																																				</div>
																																								<div class="fusion-column fusion-column-last col-lg-3 col-md-3 col-sm-3">
												<div id="text-7" class="fusion-footer-widget-column widget widget_text"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">Let’s Discuss</h4>			<div class="textwidget"><div id="menu">
<p><span class="orange-text">DevelopIntelligence</span> has been in the technical/software development learning and training industry for nearly 20 years. We’ve provided learning solutions to more than 48,000 engineers, across 220 organizations worldwide. </p>
<h4 data-fontsize="18" data-lineheight="27"><span class="orange-text"><a href="http://www.developintelligence.com/contact-developintelligence">Let's discuss your training goals.</a>
</span></h4></div></div>
		<div style="clear:both;"></div></div>																																				</div>
																																																									
									<div class="fusion-clearfix"></div>
								</div> <!-- fusion-columns -->
							</div> <!-- fusion-row -->
						</footer> <!-- fusion-footer-widget-area -->
					
																
						<footer id="footer" class="fusion-footer-copyright-area fusion-footer-copyright-center">
							<div class="fusion-row">
								<div class="fusion-copyright-content">

											<div class="fusion-copyright-notice" style="padding-bottom: 0px;">
			<div>Copyright; 2017, Develop Intelligence | All Rights Reserved.
</div>
		</div>
					<div class="fusion-social-links-footer" style="display: none;">
							</div>
		
								</div> <!-- fusion-fusion-copyright-content -->
							</div> <!-- fusion-row -->
						</footer> <!-- #footer -->
														</div> <!-- fusion-footer -->
					</div> <!-- wrapper -->

				
		<a class="fusion-one-page-text-link fusion-page-load-link"></a>

		<!-- W3TC-include-js-head -->

		<script>
window.onload = function() {
 
 var link = document.querySelector("a.fusion-logo-link");
 link.setAttribute("href", "http://www.developintelligence.com/");
};
</script>

<link rel="stylesheet" id="gforms_reset_css-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/formreset.min.css" type="text/css" media="all">
<link rel="stylesheet" id="gforms_formsmain_css-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/formsmain.min.css" type="text/css" media="all">
<link rel="stylesheet" id="gforms_ready_class_css-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/readyclass.min.css" type="text/css" media="all">
<link rel="stylesheet" id="gforms_browsers_css-css" href="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/browsers.min.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var code_prettify_settings = {"base_url":"http:\/\/www.developintelligence.com\/blog\/wp-content\/plugins\/code-prettify\/prettify"};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
var leadin_wordpress = {"userRole":"visitor","pageType":"post","leadinPluginVersion":"6.1.4"};
/* ]]> */
</script>
<script type="text/javascript" async="" defer="" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/550954.js(2).下载"></script>
<script type="text/javascript">
/* <![CDATA[ */
var toTopscreenReaderText = {"label":"Go to Top"};
var avadaVars = {"admin_ajax":"http:\/\/www.developintelligence.com\/blog\/wp-admin\/admin-ajax.php","admin_ajax_nonce":"222b0f6979","protocol":"","theme_url":"http:\/\/www.developintelligence.com\/blog\/wp-content\/themes\/Avada","dropdown_goto":"Go to...","mobile_nav_cart":"Shopping Cart","page_smoothHeight":"false","flex_smoothHeight":"false","language_flag":"","infinite_blog_finished_msg":"<em>All posts displayed.<\/em>","infinite_finished_msg":"<em>All items displayed.<\/em>","infinite_blog_text":"<em>Loading the next set of posts...<\/em>","portfolio_loading_text":"<em>Loading Portfolio Items...<\/em>","faqs_loading_text":"<em>Loading FAQ Items...<\/em>","order_actions":"Details","avada_rev_styles":"0","avada_styles_dropdowns":"1","blog_grid_column_spacing":"40","blog_pagination_type":"Pagination","carousel_speed":"2500","counter_box_speed":"1000","content_break_point":"800","disable_mobile_animate_css":"0","disable_mobile_image_hovers":"1","portfolio_pagination_type":"Pagination","form_bg_color":"#ffffff","header_transparency":"0","header_padding_bottom":"0px","header_padding_top":"0px","header_position":"Top","header_sticky":"1","header_sticky_tablet":"0","header_sticky_mobile":"0","header_sticky_type2_layout":"menu_only","sticky_header_shrinkage":"1","is_responsive":"1","is_ssl":"false","isotope_type":"masonry","layout_mode":"wide","lightbox_animation_speed":"Normal","lightbox_arrows":"1","lightbox_autoplay":"0","lightbox_behavior":"all","lightbox_desc":"1","lightbox_deeplinking":"1","lightbox_gallery":"1","lightbox_opacity":"0.9","lightbox_path":"vertical","lightbox_post_images":"1","lightbox_skin":"metro-white","lightbox_slideshow_speed":"5000","lightbox_social":"1","lightbox_title":"1","lightbox_video_height":"720","lightbox_video_width":"1280","logo_alignment":"Left","logo_margin_bottom":"10px","logo_margin_top":"10px","megamenu_max_width":"1100","mobile_menu_design":"modern","nav_height":"70","nav_highlight_border":"0","page_title_fading":"0","pagination_video_slide":"0","related_posts_speed":"2500","submenu_slideout":"1","side_header_break_point":"800","sidenav_behavior":"Hover","site_width":"95%","slider_position":"below","slideshow_autoplay":"1","slideshow_speed":"7000","smooth_scrolling":"0","status_lightbox":"1","status_totop_mobile":"0","status_vimeo":"1","status_yt":"1","testimonials_speed":"4000","tfes_animation":"sides","tfes_autoplay":"1","tfes_interval":"3000","tfes_speed":"800","tfes_width":"150","title_style_type":"double","title_margin_top":"0px","title_margin_bottom":"31px","typography_responsive":"0","typography_sensitivity":"0.6","typography_factor":"1.5","woocommerce_shop_page_columns":"","woocommerce_checkout_error":"Not all fields have been filled in correctly.","side_header_width":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/main.min.js.下载" async=""></script> 
<!--[if IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/avada-ie9.js?ver=5.0.6'></script>
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/respond.js?ver=5.0.6'></script>
<![endif]-->
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/wp-embed.min.js.下载"></script>
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/jquery.maskedinput.min.js.下载"></script>
<script type="text/javascript" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/placeholders.jquery.min.js.下载"></script>
<!-- Facebook Comments Plugin for WordPress: http://peadig.com/wordpress-plugins/facebook-comments/ -->
<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/lY4eZXm_YWu.html" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/lY4eZXm_YWu(1).html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="f230baa294b452c" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/ping.html" style="display: none;"></iframe></div></div></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=708166696026776&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

		<script type="text/javascript">
_linkedin_data_partner_id = "95643";
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
&lt;img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=95643&amp;fmt=gif" /&gt;
</noscript>	
<div class="to-top-container"><a href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/#" id="toTop" style="display: inline; opacity: 0.875497;"><span id="toTopHover"></span><span class="screen-reader-text">Go to Top</span></a></div><script src="./Predicting Yelp Stars from Reviews with scikit-learn and Python _ DevelopIntelligence Blog_files/saved_resource" type="text/javascript"></script></body></html>