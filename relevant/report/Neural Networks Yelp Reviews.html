<!DOCTYPE html>
<!-- saved from url=(0105)http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/ -->
<html class="gr__developintelligence_com ua-windows_nt ua-windows_nt-10 ua-windows_nt-10-0 ua-chrome ua-chrome-63 ua-chrome-63-0 ua-chrome-63-0-3239 ua-chrome-63-0-3239-132 ua-desktop ua-desktop-windows ua-webkit ua-webkit-537 ua-webkit-537-36 js applicationcache geolocation history postmessage websockets localstorage sessionstorage websqldatabase webworkers hashchange audio canvas canvastext video webgl cssgradients multiplebgs opacity rgba inlinesvg hsla supports svgclippaths smil no-touchevents fontface generatedcontent textshadow indexeddb indexeddb-deletedatabase cssanimations backgroundsize borderimage borderradius boxshadow flexbox cssreflections csstransforms csstransforms3d csstransitions" lang="en-US" xmlns:fb="http://ogp.me/ns/fb#" prefix="og: http://ogp.me/ns#" data-useragent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36" style="overflow-y: auto;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	

	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Practical Neural Networks with Keras: Classifying Yelp Reviews | DevelopIntelligence Blog</title>

<!-- This site is optimized with the Yoast SEO plugin v5.1 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Practical Neural Networks with Keras: Classifying Yelp Reviews | DevelopIntelligence Blog">
<meta property="og:description" content="Keras is a high-level deep learning library that makes it easy to build Neural Networks in a few lines of …">
<meta property="og:url" content="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/">
<meta property="og:site_name" content="DevelopIntelligence Blog">
<meta property="article:publisher" content="https://www.facebook.com/DevelopIntelligence/">
<meta property="article:section" content="Python">
<meta property="article:published_time" content="2017-06-01T17:01:03+00:00">
<meta property="article:modified_time" content="2017-08-17T21:03:59+00:00">
<meta property="og:updated_time" content="2017-08-17T21:03:59+00:00">
<meta property="og:image" content="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent.png">
<meta property="og:image:width" content="700">
<meta property="og:image:height" content="400">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="Keras is a high-level deep learning library that makes it easy to build Neural Networks in a few lines of […]">
<meta name="twitter:title" content="Practical Neural Networks with Keras: Classifying Yelp Reviews | DevelopIntelligence Blog">
<meta name="twitter:image" content="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent.png">
<meta name="twitter:creator" content="@sixhobbits">
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="http://js.hs-scripts.com/">
<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="DevelopIntelligence Blog » Feed" href="http://www.developintelligence.com/blog/feed/">
<link rel="alternate" type="application/rss+xml" title="DevelopIntelligence Blog » Comments Feed" href="http://www.developintelligence.com/blog/comments/feed/">
			<!-- For iPad Retina display -->
			<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/">
				<script src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/550954.js.下载" type="text/javascript" id="hs-script-loader"></script><script src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/550954.js(1).下载" type="text/javascript" id="hs-analytics"></script><script type="text/javascript" async="" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/analytics.js.下载"></script><script type="text/javascript" async="" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/insight.min.js.下载"></script><script id="facebook-jssdk" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/sdk.js.下载"></script><script async="" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/gtm.js.下载"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.developintelligence.com\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/wp-emoji-release.min.js.下载" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="ts_fab_css-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/ts-fab.min.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-stylesheet-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="child-style-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/style.css" type="text/css" media="all">
<!--[if lte IE 9]>
<link rel='stylesheet' id='avada-shortcodes-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/shortcodes.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="fontawesome-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/font-awesome.css" type="text/css" media="all">
<!--[if lte IE 9]>
<link rel='stylesheet' id='avada-IE-fontawesome-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/fonts/fontawesome/font-awesome.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<!--[if lte IE 8]>
<link rel='stylesheet' id='avada-IE8-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/css/ie8.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<!--[if IE]>
<link rel='stylesheet' id='avada-IE-css'  href='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/css/ie.css?ver=5.0.6' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="avada-iLightbox-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/ilightbox.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-animations-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/animations.css" type="text/css" media="all">
<link rel="stylesheet" id="wordpress-popular-posts-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/wpp.css" type="text/css" media="all">
<link rel="stylesheet" id="fusion-builder-shortcodes-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/fusion-shortcodes.min.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-dynamic-css-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/avada-7111.css" type="text/css" media="all">
<link rel="stylesheet" id="avada_google_fonts-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/css" type="text/css" media="all">
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/jquery.js.下载"></script>
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/jquery-migrate.min.js.下载"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.developintelligence.com\/blog\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/crayon.min.js.下载"></script>
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/ts-fab.min.js.下载"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/html5shiv.js?ver=5.0.6'></script>
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/excanvas.js?ver=5.0.6'></script>
<![endif]-->
<link rel="https://api.w.org/" href="http://www.developintelligence.com/blog/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.developintelligence.com/blog/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.developintelligence.com/blog/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="http://www.developintelligence.com/blog/?p=7111">
<link rel="alternate" type="application/json+oembed" href="http://www.developintelligence.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F06%2Fpractical-neural-networks-keras-classifying-yelp-reviews%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.developintelligence.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F06%2Fpractical-neural-networks-keras-classifying-yelp-reviews%2F&amp;format=xml">


<meta property="fb:app_id" content="708166696026776">	<style>
	.ts-fab-list li a { background-color: #ffffff; border: 1px solid #ffffff; color: #888; }
	.ts-fab-list li.active a { background-color: #a5a5a5; border: 1px solid #a5a5a5; color: #fff; }
	.ts-fab-tab { background-color: #ffffff; border: 2px solid #d2d2d2; color: #888; }
	</style>
	

<!-- Plugin: Open external links a new window. Plugin by Kristian Risager Larsen, http://kristianrisagerlarsen.dk . Download it at http://wordpress.org/extend/plugins/open-external-links-in-a-new-window/ -->
<script type="text/javascript">//<![CDATA[
	function external_links_in_new_windows_loop() {
		if (!document.links) {
			document.links = document.getElementsByTagName('a');
		}
		var change_link = false;
		var force = '';
		var ignore = '';

		for (var t=0; t<document.links.length; t++) {
			var all_links = document.links[t];
			change_link = false;
			
			if(document.links[t].hasAttribute('onClick') == false) {
				// forced if the address starts with http (or also https), but does not link to the current domain
				if(all_links.href.search(/^http/) != -1 && all_links.href.search('www.developintelligence.com') == -1) {
					// alert('Changeda '+all_links.href);
					change_link = true;
				}
					
				if(force != '' && all_links.href.search(force) != -1) {
					// forced
					// alert('force '+all_links.href);
					change_link = true;
				}
				
				if(ignore != '' && all_links.href.search(ignore) != -1) {
					// alert('ignore '+all_links.href);
					// ignored
					change_link = false;
				}

				if(change_link == true) {
					// alert('Changed '+all_links.href);
					document.links[t].setAttribute('onClick', 'javascript:window.open(\''+all_links.href+'\'); return false;');
					document.links[t].removeAttribute('target');
				}
			}
		}
	}
	
	// Load
	function external_links_in_new_windows_load(func)
	{	
		var oldonload = window.onload;
		if (typeof window.onload != 'function'){
			window.onload = func;
		} else {
			window.onload = function(){
				oldonload();
				func();
			}
		}
	}

	external_links_in_new_windows_load(external_links_in_new_windows_loop);
	//]]></script>

				<!-- WordPress Popular Posts v3.3.4 -->
				<script type="text/javascript">

					var sampling_active = 0;
					var sampling_rate   = 100;
					var do_request = false;

					if ( !sampling_active ) {
						do_request = true;
					} else {
						var num = Math.floor(Math.random() * sampling_rate) + 1;
						do_request = ( 1 === num );
					}

					if ( do_request ) {

						/* Create XMLHttpRequest object and set variables */
						var xhr = ( window.XMLHttpRequest )
						  ? new XMLHttpRequest()
						  : new ActiveXObject( "Microsoft.XMLHTTP" ),
						url = 'http://www.developintelligence.com/blog/wp-admin/admin-ajax.php',
						params = 'action=update_views_ajax&token=662404f2b5&wpp_id=7111';
						/* Set request method and target URL */
						xhr.open( "POST", url, true );
						/* Set request header */
						xhr.setRequestHeader( "Content-type", "application/x-www-form-urlencoded" );
						/* Hook into onreadystatechange */
						xhr.onreadystatechange = function() {
							if ( 4 === xhr.readyState && 200 === xhr.status ) {
								if ( window.console && window.console.log ) {
									window.console.log( xhr.responseText );
								}
							}
						};
						/* Send request */
						xhr.send( params );

					}

				</script>
				<!-- End WordPress Popular Posts v3.3.4 -->
				<style type="text/css" id="syntaxhighlighteranchor"></style>

	
	<script type="text/javascript">
		var doc = document.documentElement;
		doc.setAttribute('data-useragent', navigator.userAgent);
	</script>

	<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MP6C47');</script>
<!-- End Google Tag Manager -->
	<link rel="stylesheet" type="text/css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/prettify.css"><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in{animation-duration:250ms;animation-name:fb_bounce_in}.fb_customer_chat_bounce_out{animation-duration:250ms;animation-name:fb_fade_out}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{height:100%;overflow:hidden;position:fixed;width:100%}@keyframes fb_fade_out{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_in{0%{opacity:0;transform:scale(.8, .8);transform-origin:100% 100%}10%{opacity:.1}20%{opacity:.2}30%{opacity:.3}40%{opacity:.4}50%{opacity:.5}60%{opacity:.6}70%{opacity:.7}80%{opacity:.8;transform:scale(1.03, 1.03)}90{opacity:.9}100%{opacity:1;transform:scale(1, 1)}}</style></head>
<body class="single single-post postid-7111 single-format-standard fusion-body no-tablet-sticky-header no-mobile-sticky-header no-mobile-slidingbar no-totop no-mobile-totop mobile-logo-pos-left layout-wide-mode has-sidebar fusion-top-header menu-text-align-center mobile-menu-design-modern fusion-image-hovers fusion-show-pagination-text do-animate" data-gr-c-s-loaded="true">
				<div id="wrapper" class="">
		<div id="home" style="position:relative;top:1px;"></div>
				
		
			<header class="fusion-header-wrapper fusion-is-sticky">
				<div class="fusion-header-v1 fusion-logo-left fusion-sticky-menu-1 fusion-sticky-logo-1 fusion-mobile-logo-1 fusion-mobile-menu-design-modern ">
					<div class="fusion-header-sticky-height" style="height: 65px; display: block; overflow: visible;"></div>
<div class="fusion-header fusion-sticky-shadow" style="height: 65px; top: 0px; overflow: visible;">
	<div class="fusion-row" style="padding-top: 0px; padding-bottom: 0px;">
		
<div class="fusion-logo" data-margin-top="10px" data-margin-bottom="10px" data-margin-left="0px" data-margin-right="0px" style="margin-top: 7.5px; margin-bottom: 7.5px;">
				<a class="fusion-logo-link" href="http://www.developintelligence.com/">
						<img src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/di-logo.jpg" width="340" height="50" alt="DevelopIntelligence Blog" class="fusion-logo-1x fusion-standard-logo">

															<img src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/di-logo@2x.jpg" width="340" height="50" alt="DevelopIntelligence Blog" style="max-height: 50px; height: auto;" class="fusion-standard-logo fusion-logo-2x">
			
			<!-- mobile logo -->
											<img src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/di-logo.jpg" width="340" height="50" alt="DevelopIntelligence Blog" class="fusion-logo-1x fusion-mobile-logo-1x">

														<img src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/di-logo@2x.jpg" width="340" height="50" alt="DevelopIntelligence Blog" style="max-height: 50px; height: auto;" class="fusion-logo-2x fusion-mobile-logo-2x">
							
			<!-- sticky header logo -->
											<img src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/di-logo.jpg" width="340" height="50" alt="DevelopIntelligence Blog" class="fusion-logo-1x fusion-sticky-logo-1x" data-logo-height="50" data-logo-width="340" style="height: 50px;">

														<img src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/di-logo@2x.jpg" width="340" height="50" alt="DevelopIntelligence Blog" style="max-height: 50px;" class="fusion-logo-2x fusion-sticky-logo-2x">
									</a>
		</div>		<nav class="fusion-main-menu" style=""><ul id="menu-main-menu" class="fusion-menu"><li id="menu-item-1122" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1122"><a href="http://www.developintelligence.com/" style="line-height: 65px; height: 65px;"><span class="menu-text">Home</span></a></li><li id="menu-item-6808" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6808"><a href="http://www.developintelligence.com/solutions" style="line-height: 65px; height: 65px;"><span class="menu-text">Solutions</span></a></li><li id="menu-item-6809" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6809"><a href="http://www.developintelligence.com/catalog" style="line-height: 65px; height: 65px;"><span class="menu-text">Courses</span></a></li><li id="menu-item-12" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-12"><a href="http://www.developintelligence.com/blog/why-developintelligence/" style="line-height: 65px; height: 65px;"><span class="menu-text">Why Us</span></a></li><li id="menu-item-6810" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6810 fusion-last-menu-item"><a href="http://www.developintelligence.com/contact-developintelligence" style="line-height: 65px; height: 65px;"><span class="menu-text">Contact</span></a></li></ul></nav><nav class="fusion-main-menu fusion-sticky-menu"><ul id="menu-main-menu-1" class="fusion-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1122"><a href="http://www.developintelligence.com/" style="line-height: 65px; height: 65px;"><span class="menu-text">Home</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6808"><a href="http://www.developintelligence.com/solutions" style="line-height: 65px; height: 65px;"><span class="menu-text">Solutions</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6809"><a href="http://www.developintelligence.com/catalog" style="line-height: 65px; height: 65px;"><span class="menu-text">Courses</span></a></li><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-12"><a href="http://www.developintelligence.com/blog/why-developintelligence/" style="line-height: 65px; height: 65px;"><span class="menu-text">Why Us</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6810 fusion-last-menu-item"><a href="http://www.developintelligence.com/contact-developintelligence" style="line-height: 65px; height: 65px;"><span class="menu-text">Contact</span></a></li></ul></nav>			<div class="fusion-mobile-menu-icons">
							<a href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#" class="fusion-icon fusion-icon-bars"></a>
		
		
			</div>


<nav class="fusion-mobile-nav-holder" style="display: none;"><ul id="menu-main-menu" class="fusion-menu"><li id="mobile-menu-item-1122" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/"><span class="menu-text">Home</span></a></li><li id="mobile-menu-item-6808" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/solutions"><span class="menu-text">Solutions</span></a></li><li id="mobile-menu-item-6809" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/catalog"><span class="menu-text">Courses</span></a></li><li id="mobile-menu-item-12" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/blog/why-developintelligence/"><span class="menu-text">Why Us</span></a></li><li id="mobile-menu-item-6810" class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/contact-developintelligence"><span class="menu-text">Contact</span></a></li></ul></nav>

	<nav class="fusion-mobile-nav-holder fusion-mobile-sticky-nav-holder" style="display: none;"><ul id="menu-main-menu-1" class="fusion-menu"><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/"><span class="menu-text">Home</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/solutions"><span class="menu-text">Solutions</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/catalog"><span class="menu-text">Courses</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/blog/why-developintelligence/"><span class="menu-text">Why Us</span></a></li><li class="fusion-mobile-nav-item" style=""><a href="http://www.developintelligence.com/contact-developintelligence"><span class="menu-text">Contact</span></a></li></ul></nav>
	</div>
</div>
				</div>
				<div class="fusion-clearfix"></div>
			</header>
					
		<div id="sliders-container">
					</div>
				
					<div class="fusion-page-title-bar fusion-page-title-bar-none fusion-page-title-bar-center">
	<div class="fusion-page-title-row">
		<div class="fusion-page-title-wrapper">
			<div class="fusion-page-title-captions">

																			<h1 class="entry-title" data-fontsize="34" data-lineheight="47">Practical Neural Networks with Keras: Classifying Yelp Reviews</h1>

									
													
			</div>

			
		</div>
	</div>
</div>
		
		
		
						<div id="main" class="clearfix width-100" style="padding-left:30px;padding-right:30px">
			<div class="fusion-row" style="max-width:100%;">

<div id="content" style="float: left;">

			<div class="single-navigation clearfix">
						<div class="fusion-sharing-box fusion-single-sharing-box share-box">
				<h4 data-fontsize="18" data-lineheight="27">Share This Article</h4>
				<div class="fusion-social-networks boxed-icons"><div class="fusion-social-networks-wrapper"><a class="fusion-social-network-icon fusion-tooltip fusion-facebook fusion-icon-facebook" style="color:#ffffff;background-color:#3b5998;border-color:#3b5998;border-radius:4px;" href="http://www.facebook.com/sharer.php?m2w&amp;s=100&amp;p[url]=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/&amp;p[images][0]=http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent.png&amp;p[title]=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Facebook" data-toggle="tooltip" title="" data-original-title="Facebook"><span class="screen-reader-text">Facebook</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-twitter fusion-icon-twitter" style="color:#ffffff;background-color:#55acee;border-color:#55acee;border-radius:4px;" href="https://twitter.com/share?text=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews&amp;url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F06%2Fpractical-neural-networks-keras-classifying-yelp-reviews%2F" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Twitter" data-toggle="tooltip" title="" data-original-title="Twitter"><span class="screen-reader-text">Twitter</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-linkedin fusion-icon-linkedin" style="color:#ffffff;background-color:#0077b5;border-color:#0077b5;border-radius:4px;" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/&amp;title=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews&amp;summary=Keras%20is%20a%20high-level%20deep%20learning%20library%20that%20makes%20it%20easy%20to%20build%20Neural%20Networks%20in%20a%20few%20lines%20of%20Python.%20In%20this%20post%2C%20we%26%2339%3Bll%20use%20Keras%20to%20train%20a%20text%20classifier.%20We%26%2339%3Bll%20use%20a%20subset%20of%20Yelp%20Challenge%20Dataset%2C%20which%20contains%20over%204%20million%20Yelp%20reviews%2C%20and%20we%26%2339%3Bll%20train%20our%20classifier" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Linkedin" data-toggle="tooltip" title="" data-original-title="Linkedin"><span class="screen-reader-text">Linkedin</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-reddit fusion-icon-reddit" style="color:#ffffff;background-color:#ff4500;border-color:#ff4500;border-radius:4px;" href="http://reddit.com/submit?url=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/&amp;title=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Reddit" data-toggle="tooltip" title="" data-original-title="Reddit"><span class="screen-reader-text">Reddit</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-googleplus fusion-icon-googleplus" style="color:#ffffff;background-color:#dc4e41;border-color:#dc4e41;border-radius:4px;" href="https://plus.google.com/share?url=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/" onclick="javascript:window.open(this.href,&#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Google+" data-toggle="tooltip" title="" data-original-title="Google+"><span class="screen-reader-text">Google+</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-pinterest fusion-icon-pinterest" style="color:#ffffff;background-color:#bd081c;border-color:#bd081c;border-radius:4px;" href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F06%2Fpractical-neural-networks-keras-classifying-yelp-reviews%2F&amp;description=Keras%20is%20a%20high-level%20deep%20learning%20library%20that%20makes%20it%20easy%20to%20build%20Neural%20Networks%20in%20a%20few%20lines%20of%20Python.%20In%20this%20post%2C%20we%26%2339%3Bll%20use%20Keras%20to%20train%20a%20text%20classifier.%20We%26%2339%3Bll%20use%20a%20subset%20of%20Yelp%20Challenge%20Dataset%2C%20which%20contains%20over%204%20million%20Yelp%20reviews%2C%20and%20we%26%2339%3Bll%20train%20our%20classifier&amp;media=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2Fwp-content%2Fuploads%2F2017%2F06%2FCopy-of-Copy-of-Copy-of-Creating-Persistent.png" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Pinterest" data-toggle="tooltip" title="" data-original-title="Pinterest"><span class="screen-reader-text">Pinterest</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-mail fusion-icon-mail fusion-last-social-icon" style="color:#ffffff;background-color:#000000;border-color:#000000;border-radius:4px;" href="mailto:?subject=Practical%20Neural%20Networks%20with%20Keras:%20Classifying%20Yelp%20Reviews&amp;body=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/" target="_self" rel="noopener noreferrer" data-placement="top" data-title="Email" data-toggle="tooltip" title="" data-original-title="Email"><span class="screen-reader-text">Email</span></a><div class="fusion-clearfix"></div></div></div>			</div>
						<a href="http://www.developintelligence.com/blog/2017/05/kotlin-now-first-class-language-android-android-studio-3-0/" rel="prev">Previous</a>			<a href="http://www.developintelligence.com/blog/2017/06/introduction-serverless-framework/" rel="next">Next</a>		</div>
	
			<article id="post-7111" class="post post-7111 type-post status-publish format-standard has-post-thumbnail hentry category-python category-uncategorized">
										<span class="entry-title" style="display: none;">Practical Neural Networks with Keras: Classifying Yelp Reviews</span>
			
																								<div class="fusion-flexslider flexslider post-slideshow fusion-post-slideshow">
							<ul class="slides">
																																																				<li class="flex-active-slide" style="width: 100%; float: left; margin-right: -100%; position: relative; opacity: 1; display: block; z-index: 2;">
																					<a href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/Copy-of-Copy-of-Copy-of-Creating-Persistent.png" data-rel="iLightbox[gallery7111]" title="" data-title="copy-of-copy-of-copy-of-creating-persistent" data-caption="">
												<span class="screen-reader-text">View Larger Image</span>
												<img width="700" height="400" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/Copy-of-Copy-of-Copy-of-Creating-Persistent.png" class="attachment-full size-full wp-post-image" alt="copy-of-copy-of-copy-of-creating-persistent" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent-200x114.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent-400x229.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent-600x343.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent.png 700w" sizes="(max-width: 800px) 100vw, 1315px" draggable="false">											</a>
																			</li>
																																																																																																																																																																											</ul>
						<ol class="flex-control-nav flex-control-paging"></ol><ul class="flex-direction-nav"><li><a class="flex-prev flex-disabled" href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#" tabindex="-1"></a></li><li><a class="flex-next flex-disabled" href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#" tabindex="-1"></a></li></ul></div>
																		
						<div class="post-content">
				<p><a href="https://keras.io/">Keras</a> is a high-level deep learning library that makes it easy to build <a href="https://en.wikipedia.org/wiki/Artificial_neural_network">Neural Networks</a> in a few lines of Python. In this post, we’ll use Keras to train a text classifier. We’ll use a subset of <a href="https://www.yelp.com/dataset_challenge">Yelp Challenge Dataset</a>, which contains over 4 million Yelp reviews, and we’ll train our classifier to discriminate between positive and negative reviews. Then we’ll compare the Neural Network classifier to a Support Vector Machine (SVM) on the same dataset, and show that even though Neural Networks are breaking records in most machine learning benchmarks, the humbler SVM is still a great solution for many problems.</p>
<p>Once we’re done with the classification tasks, we’ll show how to package the trained model so that we can use it for more practical purposes.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-30j0zll"></a>Prerequisites</h2>
<p>This post is aimed at people who want to learn about neural networks, machine learning, and text classification. It will help if you have used Python before, but we’ll explain all of the code in detail, so you should be able to keep up if you’re new to Python as well. We won’t be covering any of the mathematics or theory behind the deep learning concepts presented, so you’ll be able to follow even without any background in machine learning. You should have heard, and have some high-level understanding, of terms such as “Neural Network”, “Machine Learning”, “Classification” and “Accuracy”. If you’ve used SSH, or at least run commands in a shell before, some of the setup steps will be much easier.</p>
<p>If you want to follow along with the examples in this post, you’ll need an account with Amazon Web Services, as we’ll be using their Spot Instance GPU-compute machines for training. You can use your own machine, or from any other cloud provider that offers GPU-compute virtual private servers, but then you’ll need to install and configure:</p>
<ul>
<li>A Python environment with python 3, pip3, numpy, scipy, and Jupyter</li>
<li><a href="https://keras.io/">Keras</a> and <a href="https://www.tensorflow.org/">TensorFlow</a></li>
<li><a href="http://www.nvidia.com/object/cuda_home_new.html">CUDA</a> and <a href="https://developer.nvidia.com/cudnn">CuDNN</a></li>
</ul>
<p>In our example, we’ll be using the <a href="https://aws.amazon.com/marketplace/pp/B06VSPXKDX">AWS Deep Learning AMI</a>, which has all of the above pre-installed and ready to use.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-1fob9te"></a>Overview</h2>
<p>In this post, we will:</p>
<ul>
<li>Set up an AWS Spot Instance (pre-configured with a Tesla GPU, CUDA, cuDNN, and most modern machine learning libraries)</li>
<li>Load and parse the Yelp reviews in a Jupyter Notebook</li>
<li>Train and evaluate a simple Recurrent Neural Network with Long Short-Term Memory (LSTM-RNN) using Keras</li>
<li>Improve our model by adding a Convolutional Neural Network (CNN) layer</li>
<li>Compare the performance of the Neural Network classifier to a simpler SVM classifier</li>
<li>Show how to package all of our models for practical use</li>
</ul>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-3znysh7"></a>Setting up an AWS Spot Instance</h2>
<p>Because Neural Networks need a lot of computational power to train, and greatly benefit from being run on GPUs, we’ll be running all the code in this tutorial on a Virtual Private Server (VPS) through Amazon Web Services (AWS).</p>
<p>AWS offers cloud machines with high processing power, lots of RAM and modern GPUs. They auction off extra capacity by the hour through “Spot Instances” (<a href="https://aws.amazon.com/ec2/spot/">https://aws.amazon.com/ec2/spot/</a>) which are specifically designed for short-lived instances. Because we’ll only need the instance for a couple of hours at most, spot instances are ideal for us. The EC2 p2.xlarge instances that we’ll be using usually cost around $1 per hour, while the same machine using Spot Pricing is usually around $0.20 per hour (depending on current demand).</p>
<p>If you don’t have an AWS account, create one at <a href="http://aws.amazon.com/">https://aws.amazon.com</a>. You’ll need to go through a fairly long sign-up process, and have a valid credit card, but once you have an account, launching machines in the cloud can be done a few clicks.</p>
<p>Once you have an account, log in to the AWS console at <a href="http://console.aws.amazon.com/">https://console.aws.amazon.com</a> and click on the link to “EC2”, under the “Compute” category. The first thing we need to do is to pick a region into which our instance will be launched. Pick one of “US East (N. Virginia)”, “US West (Oregon)” or “EU (Ireland)” (whichever one is closest to you) as this is where the Deep Learning pre-configured machine images are available. You can select the region from the dropdown in the top right corner of the page. Once you’ve chosen your region, click on the Spot Instances link in the left column, and hit “Request Spot Instances”.</p>
<p><img class="wp-image-7112" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-spot_instances_main-png.png" alt="/Users/g/Desktop/Spot_Instances_Main.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-200x104.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-300x156.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-400x208.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-600x312.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-768x400.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-800x416.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-1024x533.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png-1200x624.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_instances_main-png.png 2500w" sizes="(max-width: 2500px) 100vw, 2500px"></p>
<p>We can accept most of the defaults in the resulting page, but we need to choose:</p>
<ul>
<li>The AMI (Amazon Machine Image): We’ll pick an image with everything we need already installed and configured.</li>
<li>The Instance Type: EC2 instances come in different shapes and sizes. We’ll pick one optimized for GPU-compute tasks, specifically the p2.xlarge instance.</li>
</ul>
<p>The easiest way to find the correct AMI is by its unique ID. Press “Search for AMI”, select “Community AMIs” from the dropdown, and paste the relevant AMI ID from here <a href="https://aws.amazon.com/marketplace/pp/B06VSPXKDX">https://aws.amazon.com/marketplace/pp/B06VSPXKDX</a> into the search box. For example, I am using the eu-west-1 (Ireland) region, so the AMI-ID is ami-c5afaaa3. Hit the select button once you’ve found the AMI, and close the pop-up, shown in the image below.</p>
<p><img class="wp-image-7113" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-select-ami-png.png" alt="/Users/g/Desktop/Select AMI.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-200x135.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-300x203.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-400x271.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-600x406.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-768x520.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-800x541.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-1024x693.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png-1200x812.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-select-ami-png.png 1652w" sizes="(max-width: 1652px) 100vw, 1652px"></p>
<p>To choose the instance type, first delete the default selection by pressing the x circled below, then press the Select button.<br>
<img class="wp-image-7114" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-main_spot_screen-png.png" alt="/Users/g/Desktop/Main_Spot_Screen.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-200x105.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-300x157.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-400x209.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-600x314.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-768x402.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-800x419.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-1024x536.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png-1200x628.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-main_spot_screen-png.png 2072w" sizes="(max-width: 2072px) 100vw, 2072px"></p>
<p>In the pop-up, choose “GPU Compute” from the “Instance Type” dropdown, and select p2.xlarge. You can have a look at the current spot price, or press “Pricing History” for a more detailed view. It’s good to check that there haven’t been any price spikes in the past few days. Finally, press “Select” to close the window.</p>
<p><img class="wp-image-7115" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-spot_select_instance-png.png" alt="/Users/g/Desktop/Spot_Select_Instance.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-200x122.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-300x183.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-400x244.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-600x365.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-768x468.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-800x487.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-1024x624.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png-1200x731.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-spot_select_instance-png.png 1934w" sizes="(max-width: 1934px) 100vw, 1934px"></p>
<p>Under the Availability Zone section, tick all three options, as we don’t care which zone our instance is in. AWS will automatically fire up an instance in the (current) cheapest zone. Press on “Next” to get to the second page of options. By “Instance store” tick the “Attach at launch” box, so that our disk will be ready for using the moment our instance boots.</p>
<p>Under “Set keypair and role”, choose a key pair. If you don’t have one yet, press “Create new key pair”, which will generate a public-private key pair. You’ll need to follow the instructions at <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html</a> if you’re not used to working with SSH and key pairs, and specifically it’s important to change the permissions on your new private key before you can use by running the following command, substituting ‘my-key-pair.pem’ with the full path and name of your private key.</p>
<p><code class=" prettyprinted" style=""><span class="pln">chmod </span><span class="lit">400</span><span class="pln"> </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">key</span><span class="pun">-</span><span class="pln">pair</span><span class="pun">.</span><span class="pln">pem</span></code></p>
<p>The last thing to configure is a security group. Large AWS machines present juicy targets to attackers who want to use them for botnets or other nefarious purposes, so by default they don’t allow any incoming traffic. As we’ll be wanting to connect to our instance via SSH, we need to configure the firewall appropriately. Select “create new security group”, and press “Create Security Group” in the next window. You’ll see a pop-up similar to the one below. Fill in the top three fields and add an incoming rule to allow SSH traffic from your IP address.</p>
<p><img class="wp-image-7116" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-security-group-png.png" alt="/Users/g/Desktop/security-group.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-200x108.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-300x162.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-400x216.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-600x325.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-768x415.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-800x433.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-1024x554.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png-1200x649.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-security-group-png.png 2056w" sizes="(max-width: 2056px) 100vw, 2056px"></p>
<p>Name the new group “allow-ssh”, and add “Allow us to SSH” as a description. Also, change the “VPC” dropdown from “No VPC” to the only other option, which is the VPC you’ll be launching the instance into. Hit the “Add Rule” button on the “Inbound” tab, and choose to allow SSH traffic under “Type”, and choose “My IP” under “Source”. This will automatically whitelist your current IP address, and allow you to connect to your instance. Click “Create”, and close the Security Groups tab to return to the Request Instance page where we were before.</p>
<p>Hit the review button at the bottom right of the page, check that all the details are correct. Then press the blue “Launch” button. Your request should be fulfilled within a few seconds, and you’ll see your instance boot up in the console under “Instances”. (Hit the Refresh button indicated below if you don’t see your new instance). Copy the public IP address, which you might need to scroll to the right to see, to the clipboard.</p>
<p><img class="wp-image-7117" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-running_instance-png.png" alt="/Users/g/Desktop/running_instance.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-200x97.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-300x145.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-400x194.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-600x291.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-768x372.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-800x388.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-1024x496.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png-1200x581.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-running_instance-png.png 2500w" sizes="(max-width: 2500px) 100vw, 2500px"></p>
<p>If the instance status in the “Spot Requests” panel gets stuck in “pending”, it might be because your AWS account hasn’t yet been verified, or because your Spot Instance limit is set to zero. You can see your limits by clicking on “Limits” in the left-hand panel, and looking for “Spot instance requests”. If your account didn’t get properly verified, you’ll be unable to launch instances. In this case, check that you’ve completed all the steps at <a href="https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/">https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/</a> and contact AWS Support if necessary.</p>
<h3 data-fontsize="22" data-lineheight="33"><a id="post-7111-2et92p0"></a>Connecting to our EC2 Instance</h3>
<p>Now we can connect to our instance via SSH. If you’re using Mac or Linux, you can SSH simply by opening a terminal and typing the following command, replacing the 11.111.111.111 with the public IP address that you copied above, and the /path/to/your/private-key.pem with the full path to your private key file.</p>
<p><code class=" prettyprinted" style=""><span class="pln">ssh </span><span class="pun">-</span><span class="pln">i </span><span class="pun">/</span><span class="pln">path</span><span class="pun">/</span><span class="pln">to</span><span class="pun">/</span><span class="pln">your</span><span class="pun">/</span><span class="kwd">private</span><span class="pun">-</span><span class="pln">key</span><span class="pun">.</span><span class="pln">pem </span><span class="pun">-</span><span class="pln">L </span><span class="lit">8888</span><span class="pun">:</span><span class="pln">localhost</span><span class="pun">:</span><span class="lit">8888</span><span class="pln"> ubuntu@11</span><span class="pun">.</span><span class="lit">111.111</span><span class="pun">.</span><span class="lit">111</span></code></p>
<p>The -i flag is for “identifier”. This cryptographically proves to AWS that we are who we say we are because we have the private key file associated with our instance. The -L flag sets up an SSH tunnel so that we can access a Jupyter Notebook running on our instance as if it were running on our local machine.</p>
<p>If you see an error when trying to connect via SSH, you can run the command again and add a -vvv flag which will show you verbose connection information. Depending on how your account is configured to use VPCs, you may need to use the public DNS address instead of the public IP address. See <a href="https://stackoverflow.com/questions/20941704/ec2-instance-has-no-public-dns">https://stackoverflow.com/questions/20941704/ec2-instance-has-no-public-dns</a> for some common issues and solutions regarding VPC settings.</p>
<p>If you’re on Windows, you can’t use the ssh command by default, but you can work around this through any of the following options:</p>
<ul>
<li>If you’re on Windows 10, you can use the Windows Subsystem for Linux (WSL). Read about how to set it up and use it here: <a href="https://msdn.microsoft.com/commandline/wsl/about">https://msdn.microsoft.com/commandline/wsl/about</a></li>
<li>If you’re on an older version of Windows, you can use PuTTy (if you prefer having a graphical user interface), or Git Tools for Windows (if you prefer the command line). You can get PuTTy and instructions on how to use it at <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html </a>or Git for Windows here <a href="https://git-for-windows.github.io/">https://git-for-windows.github.io/.</a> If you install Git for Windows, it’s important to select the “Use Git and optional Unix tools” option in the last step of the installer. You’ll then be able to use SSH directly from the Windows command prompt.</li>
<li><img class="wp-image-7118" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-git-for-windows-png.png" alt="/Users/g/Desktop/git-for-windows.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-git-for-windows-png-200x155.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-git-for-windows-png-300x233.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-git-for-windows-png-400x311.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-git-for-windows-png.png 514w" sizes="(max-width: 514px) 100vw, 514px"></li>
</ul>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-tyjcwt"></a>Running a Jupyter Notebook server</h2>
<p>After connecting to the instance, we’ll need to run a couple of commands. First, we need to upgrade Keras to version 2, which comes with many API improvements, but which breaks compatibility in a number of ways with older Keras releases. Second, we’ll run a Jupyter Notebook server inside a tmux session so that we can easily run Python code on our powerful AWS machine.</p>
<p>On the server (in the same window that you connected to the server with SSH), run the following commands:</p>
<p><code class=" prettyprinted" style=""><span class="pln">pip3 install keras </span><span class="pun">--</span><span class="pln">upgrade </span><span class="pun">--</span><span class="pln">user</span></code></p>
<p>Now open a tmux session by running:</p>
<p><code class=" prettyprinted" style=""><span class="pln">tmux</span></code></p>
<p>This creates a virtual session in the terminal. We need this in case our SSH connection breaks for any reason (e.g. if your WiFi disconnects). Usually, breaking the connection to the server automatically halts any programs that are currently running in the foreground. We don’t want this to happen while we are a few hours into the training of our neural network! Running a tmux session will allow us to resume our session after reconnecting to the server if necessary, leaving all our code running in the background.</p>
<p>Inside the tmux session, run:</p>
<p><code class=" prettyprinted" style=""><span class="pln">jupyter notebook</span></code></p>
<p>You should see output similar to the following. Copy the URL that you see in a web browser on your local machine to open up the notebook interface, from which you can easily run snippets of Python code. Code run in the notebook will be executed on the server, and Keras code will automatically be run in massively parallel batches on the GPU.</p>
<p><img class="wp-image-7119" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-jupyter_running-png.png" alt="/Users/g/Desktop/jupyter_running.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-200x25.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-300x37.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-400x50.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-600x75.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-768x96.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-800x100.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-1024x128.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png-1200x150.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_running-png.png 2034w" sizes="(max-width: 2034px) 100vw, 2034px"></p>
<p>Hit ctrl + b and tap the d key to “detach” the tmux session — now the Jupyter session is still running, but it won’t die if the connection is interrupted. You can type tmux a -t 0 (for “tmux attach session 0”) to attach the session again if you need to stop the server or view any of the output.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-3dy6vkm"></a>Loading and parsing the Yelp dataset</h2>
<p>Now download the Yelp dataset from <a href="https://www.yelp.com/dataset_challenge.">https://www.yelp.com/dataset_challenge.</a> You’ll need to fill in a form and agree to only use the data for academic purposes. The data is compressed as a .tgz file, which you can transfer to the AWS instance by running the following command on your local machine (after you have downloaded the dataset from Yelp):</p>
<p><code class=" prettyprinted" style=""><span class="pln">scp </span><span class="pun">-</span><span class="pln">i </span><span class="pun">~</span><span class="str">/path/</span><span class="pln">to</span><span class="pun">/</span><span class="pln">your</span><span class="pun">/</span><span class="kwd">private</span><span class="pun">/</span><span class="pln">key</span><span class="pun">.</span><span class="pln">pem yelp_dataset_challenge_round9</span><span class="pun">.</span><span class="pln">tgz ubuntu@11</span><span class="pun">.</span><span class="lit">111.111</span><span class="pun">.</span><span class="lit">111</span><span class="pun">:~</span></code></p>
<p>Once again, substitute with the path to your private key file and the public IP address of your VPS as appropriate. Note that the command ends with ~. The colon separates the SSH connection string of your instance from the path that you want to upload the file to, and the ~ represents the home directory of your VPS.</p>
<p>Now, <em>on the server</em> untar the dataset by running tar -xvf yelp_dataset_challenge_round9.tgz. This should extract a number of large JSON files to your home directory on the server.</p>
<p>At this point, we’re ready to start running our Python code. Create a notebook on your local machine by firing up your web browser and visiting the URL that was displayed after you ran the Jupyter notebook command. It should look similar to http://localhost:8888?token=&lt;yourlongtoken&gt;. For this to work, you need to be connected to your VPS via SSH with the -L 8888:localhost:8888 as specified earlier. In your browser, click the “new” button in the top right, and choose to create a Python 3 notebook.</p>
<p><img class="wp-image-7120" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/users-g-desktop-jupyter_create-png.png" alt="/Users/g/Desktop/jupyter_create.png" srcset="http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-200x57.png 200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-300x85.png 300w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-400x114.png 400w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-600x171.png 600w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-768x218.png 768w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-800x228.png 800w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-1024x291.png 1024w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png-1200x341.png 1200w, http://www.developintelligence.com/blog/wp-content/uploads/2017/06/users-g-desktop-jupyter_create-png.png 2500w" sizes="(max-width: 2500px) 100vw, 2500px"></p>
<p>If you haven’t used Jupyter notebook before, you’ll love it! You can easily run snippets of Python code in so-called “cells” of the notebook. All variables are available across all cells, so you never have to re-run earlier bits of code just to reload the same data. Create a new cell and run the following code. (You can insert new cells by using the “Insert -&gt; Insert Cell Below” menu at the top, and you can run the code in the current cell by hitting “Cell -&gt; Run Cells”. A useful shortcut is Shift+Enter, which will run the current cell and insert a new one below).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d7873012175826" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from collections import Counter
from datetime import datetime

import json

from keras.layers import Embedding, LSTM, Dense, Conv1D, MaxPooling1D, Dropout, Activation
from keras.models import Sequential
from keras.preprocessing.text import Tokenizer
from keras.preprocessing.sequence import pad_sequences

import numpy as np</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d7873012175826-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7873012175826-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d7873012175826-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7873012175826-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d7873012175826-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7873012175826-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d7873012175826-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7873012175826-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d7873012175826-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7873012175826-10">10</div><div class="crayon-num" data-line="crayon-5a8af6d4d7873012175826-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d7873012175826-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">collections</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7873012175826-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span></div><div class="crayon-line" id="crayon-5a8af6d4d7873012175826-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7873012175826-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">json</span></div><div class="crayon-line" id="crayon-5a8af6d4d7873012175826-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7873012175826-6"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">Embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LSTM</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Dense</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Conv1D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">MaxPooling1D</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Dropout</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Activation</span></div><div class="crayon-line" id="crayon-5a8af6d4d7873012175826-7"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7873012175826-8"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line" id="crayon-5a8af6d4d7873012175826-9"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7873012175826-10">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d7873012175826-11"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">np</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>The above code imports a bunch of libraries for us that we’ll be using later on. The first three are standard Python imports, while Keras and Numpy are third-party libraries that come installed with the Deep Learning AMI that we are using.</p>
<p>To load the reviews from disk, run the following in the next cell:</p>
<p>&nbsp;</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d788a410020690" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;"># Load the reviews and parse JSON
t1 = datetime.now()
with open("yelp_academic_dataset_review.json") as f:
 &nbsp;&nbsp;&nbsp;reviews = f.read().strip().split("\n")
reviews = [json.loads(review) for review in reviews]
print(datetime.now() - t1)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d788a410020690-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d788a410020690-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d788a410020690-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d788a410020690-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d788a410020690-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d788a410020690-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d788a410020690-1"><span class="crayon-c"># Load the reviews and parse JSON</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d788a410020690-2"><span class="crayon-v">t1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d788a410020690-3"><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-s">"yelp_academic_dataset_review.json"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d788a410020690-4"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;<span class="crayon-v">reviews</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d788a410020690-5"><span class="crayon-v">reviews</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">json</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-v">review</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">review </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">reviews</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d788a410020690-6"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">t1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>The reviews are structured as JSON objects, one per line. This code loads all the reviews, parses them into JSON, and stores them in a list called reviews. We also print out an indication of how long this took — on the AWS machine, it should run in an under a minute.</p>
<p>Each review in the Yelp dataset contains the text of the review and the associated star rating, left by the reviewer. Our task is to teach a classifier to differentiate between positive and negative reviews, looking only at the review text itself.</p>
<p>It is very important to have a balanced dataset for supervised learning. This means that we want the same amount of positive and negative reviews when we train our neural network to tell the difference between them. If we have more positive reviews than negative reviews, the network will learn that most reviews are positive, and adjust its predictions accordingly. We’ll, therefore, take a sample of the Yelp reviews which contains the same amount of positive (four or five-star reviews) and negative (one, two, or three-star reviews).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d7892174968423" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;"># Get a balanced sample of positive and negative reviews
texts = [review['text'] for review in reviews]

# Convert our 5 classes into 2 (negative or positive)
binstars = [0 if review['stars'] &lt;= 3 else 1 for review in reviews]
balanced_texts = []
balanced_labels = []
limit = 100000 &nbsp;# Change this to grow/shrink the dataset
neg_pos_counts = [0, 0]
for i in range(len(texts)):
 &nbsp;&nbsp;&nbsp;polarity = binstars[i]
 &nbsp;&nbsp;&nbsp;if neg_pos_counts[polarity] &lt; limit:
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;balanced_texts.append(texts[i])
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;balanced_labels.append(binstars[i])
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neg_pos_counts[polarity] += 1</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7892174968423-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7892174968423-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7892174968423-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7892174968423-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7892174968423-10">10</div><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7892174968423-12">12</div><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7892174968423-14">14</div><div class="crayon-num" data-line="crayon-5a8af6d4d7892174968423-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-1"><span class="crayon-c"># Get a balanced sample of positive and negative reviews</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7892174968423-2"><span class="crayon-v">texts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">review</span><span class="crayon-sy">[</span><span class="crayon-s">'text'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">review </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">reviews</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7892174968423-4"><span class="crayon-c"># Convert our 5 classes into 2 (negative or positive)</span></div><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-5"><span class="crayon-v">binstars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">review</span><span class="crayon-sy">[</span><span class="crayon-s">'stars'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">review </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">reviews</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7892174968423-6"><span class="crayon-v">balanced_texts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-7"><span class="crayon-v">balanced_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7892174968423-8"><span class="crayon-v">limit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span><span class="crayon-h"> </span>&nbsp;<span class="crayon-c"># Change this to grow/shrink the dataset</span></div><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-9"><span class="crayon-v">neg_pos_counts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7892174968423-10"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">texts</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-11"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;<span class="crayon-v">polarity</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">binstars</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7892174968423-12"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;<span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">neg_pos_counts</span><span class="crayon-sy">[</span><span class="crayon-v">polarity</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">limit</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-13"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="crayon-v">balanced_texts</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">texts</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7892174968423-14"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="crayon-v">balanced_labels</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">binstars</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d7892174968423-15"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="crayon-v">neg_pos_counts</span><span class="crayon-sy">[</span><span class="crayon-v">polarity</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0042 seconds] -->
<p>This gets 100 000 positive and 100 000 negative reviews. Feel free to use a higher or lower number, depending on your time constraints. For our dataset, we’ll need a couple of hours to train each of two different neural network models below. If you use less data, you’ll probably get significantly worse accuracy, as neural networks usually need a lot of data to train well. More data will result in longer training times for our neural network.</p>
<p>We can verify that our new dataset is balanced by using a Python Counter. In a new cell, run:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d7899424824513" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">Counter(balanced_labels)
# &gt;&gt;&gt; Counter({0: 100000, 1: 100000})</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d7899424824513-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7899424824513-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d7899424824513-1"><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_labels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7899424824513-2"><span class="crayon-p"># &gt;&gt;&gt; Counter({0: 100000, 1: 100000})</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-1t3h5sf"></a>Tokenizing the texts</h2>
<p>Machines understand numbers better than words. In order to train our neural network with our texts, we first need to split each text into words and represent each word by a number. Luckily, Keras has a preprocessing module that can handle all of this for us.</p>
<p>First, we’ll have a look at how Keras’ tokenization and sequence padding works on some toy data, in order to work out what’s going on under the hood. Then, we’ll apply the tokenization to our Yelp reviews.</p>
<p>Keras represents each word as a number, with the most common word in a given dataset being represented as 1, the second most common as a 2, and so on. This is useful because we often want to ignore rare words, as usually, the neural network cannot learn much from these, and they only add to the processing time. If we have our data tokenized with the more common words having lower numbers, we can easily train on only the <em>N</em> most common words in our dataset, and adjust <em>N</em> as necessary (for larger datasets, we would want a larger N, as even comparatively rare words will appear often enough to be useful).</p>
<p>Tokenization in Keras is a two step process. First, we need to calculate the word frequencies for our dataset (to find the most common words and assign these low numbers). Then we can transform our text into numerical tokens. The calculation of the word frequencies is referred to as ‘fitting’ the tokenizer, and Keras calls the numerical representations of our texts ‘sequences’.</p>
<p>Run the following code in a new cell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78a2718172051" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">tokenizer = Tokenizer(num_words=5)
toytexts = ["Is is a common word", "So is the", "the is common", "discombobulation is not common"]
tokenizer.fit_on_texts(toytexts)
sequences = tokenizer.texts_to_sequences(toytexts)


# &gt;&gt;&gt; [[1, 1, 4, 2], [1, 3], [3, 1, 2], [1, 2]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78a2718172051-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78a2718172051-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78a2718172051-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78a2718172051-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78a2718172051-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78a2718172051-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d78a2718172051-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78a2718172051-1"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78a2718172051-2"><span class="crayon-v">toytexts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"Is is a common word"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"So is the"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"the is common"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"discombobulation is not common"</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af6d4d78a2718172051-3"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">toytexts</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78a2718172051-4"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">toytexts</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78a2718172051-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78a2718172051-6">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78a2718172051-7"><span class="crayon-c"># &gt;&gt;&gt; [[1, 1, 4, 2], [1, 3], [3, 1, 2], [1, 2]]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<ul>
<li style="font-weight: 400;">In line one, we create a tokenizer and say that it should ignore all except the five most-common words (in practice, we’ll use a much higher number).</li>
<li style="font-weight: 400;">In line three, we tell the tokenizer to calculate the frequency of each word in our toy dataset.</li>
<li style="font-weight: 400;">In line four, we convert all of our texts to lists of integers</li>
</ul>
<p>We can have a look at the sequences to see how the tokenization works.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78a9318853516" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">print(sequences)
# &gt;&gt;&gt; [[1, 1, 4, 2], [1, 3], [3, 1, 2], [1, 2]]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78a9318853516-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78a9318853516-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78a9318853516-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78a9318853516-2"><span class="crayon-p"># &gt;&gt;&gt; [[1, 1, 4, 2], [1, 3], [3, 1, 2], [1, 2]]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can see that each text is represented by a list of integers. The first text is 1, 1, 4, 2. By looking at the other sequences, we can infer that 1 represents the word “is”, 4 represents “a”, and 2 represents “common”. We can take a look at the tokenizer word_index, which stores to the word-to-token mapping to confirm this:</p>
<p><code class=" prettyprinted" style=""><span class="kwd">print</span><span class="pun">(</span><span class="pln">tokenizer</span><span class="pun">.</span><span class="pln">word_index</span><span class="pun">)</span></code></p>
<p>which outputs:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78ae121432936" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">{'a': 4,
 'common': 2,
 'discombobulation': 7,
 'is': 1,
 'not': 8,
 'so': 6,
 'the': 3,
 'word': 5}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78ae121432936-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ae121432936-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ae121432936-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ae121432936-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ae121432936-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ae121432936-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ae121432936-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ae121432936-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78ae121432936-1"><span class="crayon-sy">{</span><span class="crayon-s">'a'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ae121432936-2"><span class="crayon-h"> </span><span class="crayon-s">'common'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ae121432936-3"><span class="crayon-h"> </span><span class="crayon-s">'discombobulation'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ae121432936-4"><span class="crayon-h"> </span><span class="crayon-s">'is'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ae121432936-5"><span class="crayon-h"> </span><span class="crayon-s">'not'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ae121432936-6"><span class="crayon-h"> </span><span class="crayon-s">'so'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ae121432936-7"><span class="crayon-h"> </span><span class="crayon-s">'the'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ae121432936-8"><span class="crayon-h"> </span><span class="crayon-s">'word'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Rare words, such as “discombobulation” did not make the cut of “5 most common words”, and are therefore omitted from the sequences. You can see the last text is represented only by [1,2] even though it originally contained four words, because two of the words are not part of the top 5 words.</p>
<p>Finally, we’ll want to “pad” our sequences. Our neural network can train more efficiently if all of the training examples are the same size, so we want each of our texts to contain the same number of words. Keras has the pad_sequences function to do this, which will pad with leading zeros to make all the texts the same length as the longest one:</p>
<p><code class=" prettyprinted" style=""><span class="pln">padded_sequences </span><span class="pun">=</span><span class="pln"> pad_sequences</span><span class="pun">(</span><span class="pln">sequences</span><span class="pun">)</span></code></p>
<p><code class=" prettyprinted" style=""><span class="kwd">print</span><span class="pun">(</span><span class="pln">padded_sequences</span><span class="pun">)</span></code></p>
<p>Which outputs:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78b4637030141" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">array([[1, 1, 4, 2],
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0, 0, 1, 3],
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0, 3, 1, 2],
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0, 0, 1, 2]], dtype=int32)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78b4637030141-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78b4637030141-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78b4637030141-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78b4637030141-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78b4637030141-1"><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78b4637030141-2"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5a8af6d4d78b4637030141-3"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78b4637030141-4"><span class="crayon-h"> </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-v">int32</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>The last text has now been transformed from [1, 2] to [0, 0, 1, 2] in order to make it as long as the longest text (the first one).</p>
<p>Now that we’ve seen how tokenization works, we can create the real tokenized sequences from the Yelp reviews. Run the following code in a new cell.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78bc443777668" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">tokenizer = Tokenizer(num_words=20000)
tokenizer.fit_on_texts(balanced_texts)
sequences = tokenizer.texts_to_sequences(balanced_texts)
data = pad_sequences(sequences, maxlen=300)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78bc443777668-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78bc443777668-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78bc443777668-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78bc443777668-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78bc443777668-1"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-cn">20000</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78bc443777668-2"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_texts</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78bc443777668-3"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_texts</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78bc443777668-4"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>This might take a while to run. Here, we use the most common 20000 words instead of 5. The only other difference is that we pass maxlen=300 when we pad the sequences. This means that as well as padding the very short texts with zeros, we’ll also truncate the very long ones. All of our texts will then be represented by 300 numbers.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-4d34og8"></a>Building a neural network</h2>
<p>There are different ways of building a neural network. One of the more complicated architectures, which is known to perform very well on text data, is the Recurrent Neural Network (RNN) with Long Short-Term Memory (LSTM). RNNs are designed to learn from sequences of data, where there is some kind of time dependency. For example, they are used for time-series analysis, where each data point has some relation to those immediately before and after. By extension, they work very well for language data, where each word is related to those before and after it in a sentence.</p>
<p>The maths behind RNNs gets a bit hairy, and even more so when we add the concept LSTMs, which allows the neural network to pay more attention to certain parts of a sequence, and to largely ignore words which aren’t as useful. In spite of the internal complications, with Keras we can set up one of these networks in a few lines of code<sup><sup><a id="post-7111-footnote-ref-0" href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#post-7111-footnote-0">[1]</a></sup></sup>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78c3945471096" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">model = Sequential()
model.add(Embedding(20000, 128, input_length=300))
model.add(LSTM(128, dropout=0.2, recurrent_dropout=0.2))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])In line two, we add an Embedding layer. This layer lets the network expand each token to a larger vector, allowing the network to represent words in a meaningful way. We pass 20000 as the first argument, which is the size of our vocabulary (remember, we told the tokenizer to only use the 20 000 most common words earlier), and 128 as the second, which means that each token can be expanded to a vector of size 128. We give it an input_length of 300, which is the length of each of our sequences.</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78c3945471096-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78c3945471096-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78c3945471096-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78c3945471096-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78c3945471096-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78c3945471096-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78c3945471096-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-cn">20000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78c3945471096-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">recurrent_dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78c3945471096-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78c3945471096-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-k ">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-st">In</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-v">two</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">we </span><span class="crayon-e">add </span><span class="crayon-e">an </span><span class="crayon-e">Embedding </span><span class="crayon-v">layer</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">This </span><span class="crayon-e">layer </span><span class="crayon-e">lets </span><span class="crayon-e">the </span><span class="crayon-e">network </span><span class="crayon-e">expand </span><span class="crayon-e">each </span><span class="crayon-k ">token</span><span class="crayon-h"> </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">larger </span><span class="crayon-v">vector</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">allowing </span><span class="crayon-e">the </span><span class="crayon-e">network </span><span class="crayon-e">to </span><span class="crayon-e">represent </span><span class="crayon-e">words </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">meaningful </span><span class="crayon-v">way</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">We </span><span class="crayon-r">pass</span><span class="crayon-h"> </span><span class="crayon-cn">20000</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">first </span><span class="crayon-v">argument</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">which </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">size </span><span class="crayon-e">of </span><span class="crayon-e">our </span><span class="crayon-e">vocabulary</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">remember</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">we </span><span class="crayon-e">told </span><span class="crayon-e">the </span><span class="crayon-e">tokenizer </span><span class="crayon-e">to </span><span class="crayon-e">only </span><span class="crayon-e">use </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">000</span><span class="crayon-h"> </span><span class="crayon-e">most </span><span class="crayon-e">common </span><span class="crayon-e">words </span><span class="crayon-v">earlier</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-v">second</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">which </span><span class="crayon-e">means </span><span class="crayon-e">that </span><span class="crayon-e">each </span><span class="crayon-k ">token</span><span class="crayon-h"> </span><span class="crayon-e">can </span><span class="crayon-e">be </span><span class="crayon-e">expanded </span><span class="crayon-i">to</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">vector </span><span class="crayon-e">of </span><span class="crayon-i">size</span><span class="crayon-h"> </span><span class="crayon-cn">128.</span><span class="crayon-h"> </span><span class="crayon-e">We </span><span class="crayon-e">give </span><span class="crayon-e">it </span><span class="crayon-e">an </span><span class="crayon-e">input_length </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">which </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">length </span><span class="crayon-e">of </span><span class="crayon-e">each </span><span class="crayon-e">of </span><span class="crayon-e">our </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0065 seconds] -->
<p></p>
<ul>
<li>In line one, we create an empty Sequential model. We’ll use this to add several “layers” to our network. Each layer will do something slightly different in our case, so we’ll explain these separately below.</li>
<li>In line two, we add an Embedding layer. This layer lets the network expand each token to a larger vector, allowing the network to represent a words in a meaningful way. We pass 20000 as the first argument, which is the size of our vocabulary (remember, we told the tokenizer to only use the 20 000 most common words earlier), and 128 as the second, which means that each token can be expanded to a vector of size 128. We give it an input_length of 300, which is the length of each of our sequences.</li>
</ul>
<ul>
<li>In line three, we add an LSTM layer. The first argument is 128, which is the size of our word embeddings (the second argument from the Embedding layer). We add a 20% chance of dropout with the next two arguments. Dropout is a slightly counter-intuitive concept: we reset a random 20% of the weights from the LSTM layer with every iteration. This makes it more difficult for the neural network to learn patterns, which results in a more robust network, as the rules the network learns are more generalisable.</li>
<li>In line four, we add a Dense layer. This is the simplest kind of Neural Network layer, where all neurons in the layer are connected to each other. This layer has an output size of 1, meaning it will always output 1 or 0. We will train the network to make this layer output 1 for positive reviews and 0 for negative ones.</li>
<li>In line five, we compile the model. This prepares the model to be run on the backend graph library (in our case, TensorFlow). We use loss=’binary_crossentropy’ because we only have two classes (1 and 0). We use the adam optimizer, which is a relatively modern learning strategy that works well in a number of different scenarios, and we specify that we are interested in the accuracy metric (how many positive/negative predictions our neural network gets correct).</li>
</ul>
<h3 data-fontsize="22" data-lineheight="33"><a id="post-7111-2s8eyo1"></a>Training our neural network</h3>
<p>Now we are ready to train or “fit” the network. This can be done in a single line of code. As this is where the actual learning takes place, you’ll need a significant amount of time to run this step (approximately two hours on the Amazon GPU machine).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78cb388437641" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">model.fit(data, np.array(balanced_labels), validation_split=0.5, epochs=3)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78cb388437641-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78cb388437641-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_labels</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_split</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Here, we pass in our padded, tokenized texts as the first argument, and the labels as the second argument. We use validation_split=0.5 to tell our neural network that it should take half of the data to learn from, and that it should test itself on the other half. This means it will take half the reviews, along with their labels, and try to find patterns in the tokens that represent positive or negative labels. It will then try to predict the answers for the other half, without looking at the labels, and compare these predictions to the real labels, to see how good the patterns it learned are.</p>
<p>It’s important to have validation data when training a neural network. The network is powerful enough to find patterns even in random noise, so by seeing that it’s able to get the correct answers on ‘new’ data (data that it didn’t look at during the training stage), we can verify that the patterns it is learning are actually useful to us, and not overly-specific to the data we trained it on.</p>
<p>The last argument we pass, epochs=3, means that the neural network should run through all of the available training data three times.</p>
<p>You should (slowly) see output similar to the below. The lower the loss is, the better for us, as this number indicates the errors that the network is making while learning. The acc number should be high, as this represents the accuracy of the training data. After each epoch completes, you’ll also see the val_loss and val_acc numbers appear, which represent the loss and accuracy on the held-out validation data.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78d5119975446" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">Train on 100000 samples, validate on 100000 samples

Epoch 1/3

100000/100000 [==============================] - 1780s - loss: 0.3974 - acc: 0.8237 - val_loss: 0.4305 - val_acc: 0.8158

Epoch 2/3

100000/100000 [==============================] - 1764s - loss: 0.2953 - acc: 0.8758 - val_loss: 0.3167 - val_acc: 0.8745

Epoch 3/3

100000/100000 [==============================] - 1754s - loss: 0.2305 - acc: 0.9057 - val_loss: 0.3296 - val_acc: 0.8589</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78d5119975446-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78d5119975446-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78d5119975446-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78d5119975446-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78d5119975446-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78d5119975446-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d78d5119975446-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78d5119975446-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d78d5119975446-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78d5119975446-10">10</div><div class="crayon-num" data-line="crayon-5a8af6d4d78d5119975446-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78d5119975446-12">12</div><div class="crayon-num" data-line="crayon-5a8af6d4d78d5119975446-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78d5119975446-1"><span class="crayon-e">Train </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-v">samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">validate </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-e">samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78d5119975446-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78d5119975446-3"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78d5119975446-4">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78d5119975446-5"><span class="crayon-cn">100000</span><span class="crayon-o">/</span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1780s</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3974</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8237</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.4305</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8158</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78d5119975446-6">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78d5119975446-7"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">/</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78d5119975446-8">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78d5119975446-9"><span class="crayon-cn">100000</span><span class="crayon-o">/</span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1764s</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2953</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8758</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3167</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8745</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78d5119975446-10">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78d5119975446-11"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">/</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78d5119975446-12">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78d5119975446-13"><span class="crayon-cn">100000</span><span class="crayon-o">/</span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1754s</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2305</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9057</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3296</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8589</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0040 seconds] -->
<p>We can see that for the first two epochs, the acc and val_acc numbers are similar. This is good. It means that the rules that the network learns on the training data generalize well to the unseen validation data. After two epochs, our network can predict whether a review is positive or negative correctly 87.5 percent of the time!</p>
<p>After the third epoch, the network is starting to memorize the training examples, with rules that are too specific. We can see that it gets 90% accuracy on the training data, but only 85.8% on the held-out validation data. This means that our network has “overfitted”, and we’d want to retrain it (by running the “compile” and “fit” steps again) for only two epochs instead of three. (We could also have told it to stop training automatically when it started overfitting by using an “Early Stopping” callback. We don’t show how to do this here, but you can read how to implement it at <a href="https://keras.io/callbacks/#earlystopping">https://keras.io/callbacks/#earlystopping</a>).</p>
<h2 data-fontsize="26" data-lineheight="39">Adding more layers</h2>
<p>Our simple model worked well enough, but it was slow to train. One way to speed up the training time is to improve our network architecture and add a “Convolutional” layer. Convolutional Neural Networks (CNNs) come from image processing. They pass a “filter” over the data, and calculate a higher-level representation. They have been shown to work surprisingly well for text, even though they have none of the sequence processing ability of LSTMs. They are also faster, as the different filters can be calculated independently of each other. LSTMs by contrast are hard to parallelise, as each calculation depends on many previous ones.</p>
<p>By adding a CNN layer <em>before</em> the LSTM, we allow the LSTM to see sequences of chunks instead of sequences of words. For example, the CNN might learn the chunk “I loved this” as a single concept and “friendly guest house” as another concept. The LSTM stacked on top of the CNN could then see the sequence [“I loved this”, “friendly guest house”] (a “sequence” of two items) and learn whether this was positive or negative, instead of having to learn the longer and more difficult sequence of the six independent items [“I”, “loved”, “this”, “friendly”, “guest”, “house”].</p>
<p>Add the definition of the new model in a new cell of the notebook:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78de114111983" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">model = Sequential()
model.add(Embedding(20000, 128, input_length=300))
model.add(Dropout(0.2))
model.add(Conv1D(64, 5, activation='relu'))
model.add(MaxPooling1D(pool_size=4))
model.add(LSTM(128))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
model.fit(data, np.array(balanced_labels), validation_split=0.5, epochs=3)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78de114111983-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78de114111983-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78de114111983-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78de114111983-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78de114111983-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78de114111983-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d78de114111983-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78de114111983-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d78de114111983-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78de114111983-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78de114111983-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-cn">20000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78de114111983-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78de114111983-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78de114111983-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78de114111983-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78de114111983-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78de114111983-8"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78de114111983-9"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_labels</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_split</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0031 seconds] -->
<p>Here we have a slightly different arrangement of layers. We add a dropout layer directly after the Embedding layer. Following this, we add a convolutional layer which passes a filter over the text to learn specific chunks or windows. After this, we have a MaxPooling layer, which combines all of the different chunked representations into a single chunk. If you’re interested in learning more about how this works (and seeing some GIFs which clarify the concept), have a look at <a href="http://www.wildml.com/2015/11/understanding-convolutional-neural-networks-for-nlp/">http://www.wildml.com/2015/11/understanding-convolutional-neural-networks-for-nlp/.</a></p>
<p>The rest of our model is the same as before. Training time should be significantly faster (about half an hour for all three epochs) and accuracy is similar. You should see output similar to the following.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78e7959781725" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">Train on 100000 samples, validate on 100000 samples

Epoch 1/3

100000/100000 [==============================] - 465s - loss: 0.3309 - acc: 0.8561 - val_loss: 0.3181 - val_acc: 0.8640

Epoch 2/3

100000/100000 [==============================] - 462s - loss: 0.2325 - acc: 0.9048 - val_loss: 0.3335 - val_acc: 0.8549

Epoch 3/3

100000/100000 [==============================] - 457s - loss: 0.1666 - acc: 0.9349 - val_loss: 0.3833 - val_acc: 0.8570</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78e7959781725-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78e7959781725-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78e7959781725-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78e7959781725-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78e7959781725-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78e7959781725-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d78e7959781725-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78e7959781725-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d78e7959781725-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78e7959781725-10">10</div><div class="crayon-num" data-line="crayon-5a8af6d4d78e7959781725-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78e7959781725-12">12</div><div class="crayon-num" data-line="crayon-5a8af6d4d78e7959781725-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78e7959781725-1"><span class="crayon-e">Train </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-v">samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">validate </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-e">samples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78e7959781725-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78e7959781725-3"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78e7959781725-4">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78e7959781725-5"><span class="crayon-cn">100000</span><span class="crayon-o">/</span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">465s</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3309</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8561</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3181</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8640</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78e7959781725-6">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78e7959781725-7"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">/</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78e7959781725-8">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78e7959781725-9"><span class="crayon-cn">100000</span><span class="crayon-o">/</span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">462s</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2325</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9048</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3335</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8549</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78e7959781725-10">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78e7959781725-11"><span class="crayon-i">Epoch</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">/</span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78e7959781725-12">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78e7959781725-13"><span class="crayon-cn">100000</span><span class="crayon-o">/</span><span class="crayon-cn">100000</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-o">===</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">457s</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.1666</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.9349</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_loss</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.3833</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">val_acc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8570</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0040 seconds] -->
<p>Although the highest accuracy looks slightly worse, it gets there much faster. We can see that the network is already overfitting after one epoch. Adding more dropout layers after the CNN and LSTM layers might improve our network still more, but this is left as an exercise to the reader.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-3rdcrjn"></a>Comparing our results to a Support Vector Machine classifier</h2>
<p>Neural Networks are great tools for many tasks. Sentiment analysis is quite straightforward though, and similar results can be achieved with much simpler algorithms. As a comparison, we’ll build a Support Vector Machine classifier using scikit-learn, another high-level machine learning Python library that allows us to create complex models in a few lines of code.</p>
<p>Run the following in a new cell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78ed088072386" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.svm import LinearSVC
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.model_selection import cross_val_score

t1 = datetime.now()
vectorizer = TfidfVectorizer(ngram_range=(1,2), min_df=3)
classifier = LinearSVC()
Xs = vectorizer.fit_transform(balanced_texts)

print(datetime.now() - t1)
print(Xs.shape)

score = cross_val_score(classifier, Xs, balanced_labels, cv=2, n_jobs=-1)

print(datetime.now() - t1)
print(score)
print(sum(score) / len(score))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-10">10</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-12">12</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-14">14</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78ed088072386-16">16</div><div class="crayon-num" data-line="crayon-5a8af6d4d78ed088072386-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-1"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">LinearSVC</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-2"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-v">feature_extraction</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">TfidfVectorizer</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-4">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-5"><span class="crayon-v">t1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-6"><span class="crayon-v">vectorizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TfidfVectorizer</span><span class="crayon-sy">(</span><span class="crayon-v">ngram_range</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_df</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-7"><span class="crayon-v">classifier</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearSVC</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-8"><span class="crayon-v">Xs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">balanced_texts</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">t1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-11"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">Xs</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-12">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-13"><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">classifier</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Xs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">balanced_labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-14">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">now</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">t1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78ed088072386-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">score</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d78ed088072386-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0034 seconds] -->
<p>Now, instead of converting each word to a single number and learning an Embedding layer, we use a term-frequency inverse document frequency (TF-IDF) vectorisation process. Using this vectorisation scheme, we ignore the <em>order</em> of the words completely, and represent each review as a large sparse matrix, with each cell representing a specific word, and how often it appears in that review. We normalize the counts by the total number of times the word appears in all of the reviews, so rare words are given a higher importance than common ones (though we ignore all words that aren’t seen in at least three different reviews.</p>
<ul>
<li>Line six sets up the vectorizer. We set ngram_range to (1,2) which means we’ll consider all words on their own but also look at all pairs of words. This is useful because we don’t have a concept of word order anymore, so looking at pairs of words as single tokens allows the classifier to learn that word pairs such as “not good” are usually negative, even though “good” is positive. We also set min_df to 3, which means that we’ll ignore words that aren’t seen at least three times (in three different reviews).</li>
<li>In line seven, we set up a support vector machine classifier with a linear kernel, as this has been shown to work well for text classification tasks.</li>
<li>In line eight, we convert our reviews into vectors by calling fit_transform. Fit transform actually does two things: first it “fits” the vectorizer, similarly to how we fitted out Tokenizer for Keras, to calculate the vocabulary across all reviews. Then it “transforms” each review into a large sparse vector.</li>
<li>In line 13, we get a cross-validated score of our classifier. This means that we train the classifier twice (because we pass in cv=2). Similarly to our validation_split for Keras, we first train on half the reviews and check our score on the other half, and then vice-versa. We set n_jobs=-1 to say that the classifier should use all available CPU cores — in our case, it will only use two as scikit-learn can only do basic parallelization and run each of the two cross-validation splits on a separate core.</li>
</ul>
<p>You should see output similar to the following.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d78f7158937595" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">0:01:22.082936

(200000, 774090)

0:01:33.442799

[ 0.86372 0.88085]

0.872285</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d78f7158937595-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78f7158937595-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d78f7158937595-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78f7158937595-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d78f7158937595-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78f7158937595-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d78f7158937595-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d78f7158937595-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d78f7158937595-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d78f7158937595-1"><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">01</span><span class="crayon-o">:</span><span class="crayon-cn">22.082936</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78f7158937595-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78f7158937595-3"><span class="crayon-sy">(</span><span class="crayon-cn">200000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">774090</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78f7158937595-4">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78f7158937595-5"><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">01</span><span class="crayon-o">:</span><span class="crayon-cn">33.442799</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78f7158937595-6">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78f7158937595-7"><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-cn">0.86372</span><span class="crayon-h"> </span><span class="crayon-cn">0.88085</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d78f7158937595-8">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d78f7158937595-9"><span class="crayon-cn">0.872285</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>We can see that the SVM is significantly faster. We need about a minute and a half to vectorize the reviews, transforming each of 200 000 reviews into a vector containing 775 090 features. It takes another minute and a half to train the classifier on 100 000 reviews and predict on the other 100 000.</p>
<p>Line four shows the accuracy for each cross-validation run, and line five shows the average of both runs. For our task, the SVM actually performs slightly better than the neural network in terms of accuracy, and it does so in significantly less time.</p>
<p>However, note that we have more flexibility with the neural network, and we could probably do better if we spent more time tuning our model. Because neural networks are not as well understood as SVMs, it can be difficult to find a good model for your data. Also note that if you want to train on even more data (we were using only a small sample of the Yelp reviews), you may well find that the neural network starts outperforming the SVM. Conversely, for smaller datasets, the SVM is much better than the neural network — try running all of the above code again for 2 000 reviews instead of 200 000 and you’ll see that the neural network really battles to find meaningful patterns if you limit the training examples. The SVM, on the other hand, will perform well even for much smaller datasets.</p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-26in1rg"></a>Packaging our models for later use</h2>
<p>Being able to predict the sentiment of this review set is not very useful on its own — after all, we have all the labels at our disposal already. However, now that we’ve trained some models, we can easily use them on new, unlabeled data. For example, you could download thousands of news reports before an election and use our model to see whether mainly positive or mainly negative things are being said about key political figures, and how that sentiment is changing over time.</p>
<p>When saving our models for later use, it’s important not to forget the tokenization. When we converted our raw texts into tokens, we fitted the tokenizer first. In the case of the neural network, the tokenizer learned which were the most frequent words in our dataset. For our SVM, we fitted a TF-IDF vectorizer. If we want to classify more texts, we must use the same tokenizers without refitting them (a new dataset will have a different most-common word, but our neural network learned specific things about the word representations from the Yelp dataset. Therefore it’s important that we still use the token 1 to refer to the same word for new data).</p>
<p>For the Keras model, we can save the tokenizer and the trained model as follows (make sure that you have h5py installed with pip3 install h5py first if you’re not using the pre-configured AWS instance).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d7900635480750" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">import pickle

# save the tokenizer and model
with open("keras_tokenizer.pickle", "wb") as f:
&nbsp;&nbsp;&nbsp;pickle.dump(tokenizer, f)
model.save("yelp_sentiment_model.hdf5")</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d7900635480750-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7900635480750-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d7900635480750-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7900635480750-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d7900635480750-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7900635480750-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d7900635480750-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7900635480750-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d7900635480750-3"><span class="crayon-c"># save the tokenizer and model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7900635480750-4"><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-s">"keras_tokenizer.pickle"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"wb"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a8af6d4d7900635480750-5">&nbsp;&nbsp;&nbsp;<span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">dump</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7900635480750-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">"yelp_sentiment_model.hdf5"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>If we want to predict whether some new piece of text is positive or negative, we can load our model and get a prediction with:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d7908192521777" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from keras.models import load_model
from keras.preprocessing.sequence import pad_sequences
import pickle

# load the tokenizer and the model
with open("keras_tokenizer.pickle", "rb") as f:
&nbsp;&nbsp;&nbsp;tokenizer = pickle.load(f)

model = load_model("yelp_sentiment_model.hdf5")

# replace with the data you want to classify
newtexts = ["Your new data", "More new data"]

# note that we shouldn't call "fit" on the tokenizer again
sequences = tokenizer.texts_to_sequences(newtexts)
data = pad_sequences(sequences, maxlen=300)

# get predictions for each of your new texts
predictions = model.predict(data)
print(predictions)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-10">10</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-12">12</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-14">14</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-16">16</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-18">18</div><div class="crayon-num" data-line="crayon-5a8af6d4d7908192521777-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d7908192521777-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-4">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-5"><span class="crayon-c"># load the tokenizer and the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-6"><span class="crayon-st">with</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-s">"keras_tokenizer.pickle"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-7">&nbsp;&nbsp;&nbsp;<span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-8">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-9"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">"yelp_sentiment_model.hdf5"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-10">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-11"><span class="crayon-c"># replace with the data you want to classify</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-12"><span class="crayon-v">newtexts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"Your new data"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"More new data"</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-14"><span class="crayon-c"># note that we shouldn't call "fit" on the tokenizer again</span></div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-15"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">newtexts</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-16"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-18"><span class="crayon-c"># get predictions for each of your new texts</span></div><div class="crayon-line" id="crayon-5a8af6d4d7908192521777-19"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d7908192521777-20"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>To package the SVM model, we similarly need to package both the vectoriser and the classifier. We can use the scikit-learn joblib module, which is designed to be faster than pickle.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a8af6d4d790e914054616" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 18px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://www.developintelligence.com/blog/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 18px !important; z-index: 0; opacity: 0; overflow: hidden;">from sklearn.externals import joblib

joblib.dump(vectorizer, "tfidf_vectorizer.pickle")
joblib.dump(classifier, "svm_classifier.pickle")

And to get predictions on new data, we can load our model from disk with:

from sklearn.externals import joblib

vectorizer = joblib.load("tfidf_vectorizer.pickle")
classifier = joblib.load("svm_classifier.pickle")

# replace with the data you want to classify
newtexts = ["Your new data", "More new data"]

# note that we should call "transform" here instead of the "fit_transform" from earlier
Xs = vectorizer.transform(newtexts)

# get predictions for each of your new texts
predictions = classifier.predict(Xs)
print(predictions)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 18px !important;"><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-2">2</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-4">4</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-6">6</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-8">8</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-10">10</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-12">12</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-14">14</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-16">16</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-18">18</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a8af6d4d790e914054616-20">20</div><div class="crayon-num" data-line="crayon-5a8af6d4d790e914054616-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 18px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">externals </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">joblib</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-2">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-3"><span class="crayon-v">joblib</span><span class="crayon-sy">.</span><span class="crayon-e">dump</span><span class="crayon-sy">(</span><span class="crayon-v">vectorizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"tfidf_vectorizer.pickle"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-4"><span class="crayon-v">joblib</span><span class="crayon-sy">.</span><span class="crayon-e">dump</span><span class="crayon-sy">(</span><span class="crayon-v">classifier</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"svm_classifier.pickle"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-6"><span class="crayon-st">And</span><span class="crayon-h"> </span><span class="crayon-e">to </span><span class="crayon-e">get </span><span class="crayon-e">predictions </span><span class="crayon-e">on </span><span class="crayon-k ">new</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">we </span><span class="crayon-e">can </span><span class="crayon-e">load </span><span class="crayon-e">our </span><span class="crayon-e">model </span><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">disk </span><span class="crayon-st">with</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-8"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">externals </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">joblib</span></div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-10"><span class="crayon-v">vectorizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">joblib</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">"tfidf_vectorizer.pickle"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-11"><span class="crayon-v">classifier</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">joblib</span><span class="crayon-sy">.</span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">"svm_classifier.pickle"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-12">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-13"><span class="crayon-c"># replace with the data you want to classify</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-14"><span class="crayon-v">newtexts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"Your new data"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"More new data"</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-16"><span class="crayon-c"># note that we should call "transform" here instead of the "fit_transform" from earlier</span></div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-17"><span class="crayon-v">Xs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">newtexts</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-18">&nbsp;</div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-19"><span class="crayon-c"># get predictions for each of your new texts</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a8af6d4d790e914054616-20"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">classifier</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">Xs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5a8af6d4d790e914054616-21"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0035 seconds] -->
<p></p>
<h2 data-fontsize="26" data-lineheight="39"><a id="post-7111-lnxbz9"></a>Conclusion</h2>
<p>We took an introductory look at using Keras for text classification and compared our results to a simpler SVM. You now know:</p>
<ul>
<li>How to set up a pre-configured AWS spot instance for machine learning</li>
<li>How to preprocess raw text data for use with Keras neural networks</li>
<li>How to experiment with building your own deep learning models for text classification</li>
<li>That an SVM is still often a good choice, in spite of advances in neural networks</li>
<li>How to package your trained models, and use them in later tasks.</li>
</ul>
<p>If you have any questions or comments, feel free to reach out to the author on <a href="https://twitter.com/sixhobbits">Twitter</a> or <a href="https://github.com/sixhobbits">github</a>.</p>
<ol>
<li id="post-7111-footnote-0">Note that the architecture that we use for our neural networks closely follows the official Keras examples which can be found at <a href="https://github.com/fchollet/keras/tree/master/examples">https://github.com/fchollet/keras/tree/master/examples</a> <a href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#post-7111-footnote-ref-0">↑</a></li>
</ol>
<div id="ts-fab-below" class="ts-fab-wrapper"><span class="screen-reader-text">The following two tabs change content below.</span><ul class="ts-fab-list"><li class="ts-fab-bio-link active"><a href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#ts-fab-bio-below">Bio</a></li><li class="ts-fab-latest-posts-link"><a href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#ts-fab-latest-posts-below">Latest Posts</a></li></ul><div class="ts-fab-tabs">
	<div class="ts-fab-tab" id="ts-fab-bio-below" style="display: block;">
		<div class="ts-fab-avatar"><img alt="mm" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/me-150x150.jpg" class="avatar avatar-80 photo" height="80" width="80"><div class="ts-fab-social-links"></div>
		</div>
		
		<div class="ts-fab-text">
			<div class="ts-fab-header"><h4 data-fontsize="18" data-lineheight="18">Gareth Dwyer</h4></div><!-- /.ts-fab-header -->
			<div class="ts-fab-content">Gareth enjoys writing. His favourite languages are Python and English, but he's not too fussy. He is author of the book "Flask by Example", and plays around with Python, Natural Language Processing, and Machine Learning. You can follow him on Twitter as @sixhobbits.</div>
		</div>
	</div>
	<div class="ts-fab-tab" id="ts-fab-latest-posts-below" style="display: none;">
		<div class="ts-fab-avatar"><img alt="mm" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/me-150x150.jpg" class="avatar avatar-80 photo" height="80" width="80"><div class="ts-fab-social-links"></div>
		</div>
		<div class="ts-fab-text">
			<div class="ts-fab-header">
				<h4 data-fontsize="18" data-lineheight="18">Latest posts by Gareth Dwyer <span class="latest-see-all">(<a href="http://www.developintelligence.com/blog/author/gareth/" rel="nofollow">see all</a>)</span></h4>
			</div>
			<ul class="ts-fab-latest">
				<li>
					<a href="http://www.developintelligence.com/blog/2017/08/building-serverless-chatbot-aws-zappa-telegram-api-ai/">Building a Serverless Chatbot w/ AWS, Zappa, Telegram, and api.ai</a><span> - August 2, 2017</span> 
				</li>
				<li>
					<a href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/">Practical Neural Networks with Keras: Classifying Yelp Reviews</a><span> - June 1, 2017</span> 
				</li>
				<li>
					<a href="http://www.developintelligence.com/blog/2017/03/predicting-yelp-star-ratings-review-text-python/">Predicting Yelp Stars from Reviews with scikit-learn and Python</a><span> - March 14, 2017</span> 
				</li>
		</ul></div>
	</div>
		</div>
	</div><!-- Facebook Comments Plugin for WordPress: http://peadig.com/wordpress-plugins/facebook-comments/ --><h3 data-fontsize="22" data-lineheight="33">Comments</h3><p><fb:comments-count href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/" fb-xfbml-state="rendered" class=""><span class="fb_comments_count">6</span></fb:comments-count> comments</p><div class="fb-comments fb_iframe_widget fb_iframe_widget_fluid" data-href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/" data-numposts="50" data-width="100%" data-colorscheme="light" fb-xfbml-state="rendered"><span style="height: 698px;"><iframe id="f341b0adcdf4edc" name="f82bf8a493ee5" scrolling="no" title="Facebook Social Plugin" class="fb_ltr" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/comments.html" style="border: none; overflow: hidden; height: 698px; width: 100%;"></iframe></span></div>							</div>
						<div class="fusion-sharing-box fusion-single-sharing-box share-box">
				<h4 data-fontsize="18" data-lineheight="27">Share This Article</h4>
				<div class="fusion-social-networks boxed-icons"><div class="fusion-social-networks-wrapper"><a class="fusion-social-network-icon fusion-tooltip fusion-facebook fusion-icon-facebook" style="color:#ffffff;background-color:#3b5998;border-color:#3b5998;border-radius:4px;" href="http://www.facebook.com/sharer.php?m2w&amp;s=100&amp;p[url]=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/&amp;p[images][0]=http://www.developintelligence.com/blog/wp-content/uploads/2017/06/Copy-of-Copy-of-Copy-of-Creating-Persistent.png&amp;p[title]=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Facebook" data-toggle="tooltip" title="" data-original-title="Facebook"><span class="screen-reader-text">Facebook</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-twitter fusion-icon-twitter" style="color:#ffffff;background-color:#55acee;border-color:#55acee;border-radius:4px;" href="https://twitter.com/share?text=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews&amp;url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F06%2Fpractical-neural-networks-keras-classifying-yelp-reviews%2F" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Twitter" data-toggle="tooltip" title="" data-original-title="Twitter"><span class="screen-reader-text">Twitter</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-linkedin fusion-icon-linkedin" style="color:#ffffff;background-color:#0077b5;border-color:#0077b5;border-radius:4px;" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/&amp;title=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews&amp;summary=Keras%20is%20a%20high-level%20deep%20learning%20library%20that%20makes%20it%20easy%20to%20build%20Neural%20Networks%20in%20a%20few%20lines%20of%20Python.%20In%20this%20post%2C%20we%26%2339%3Bll%20use%20Keras%20to%20train%20a%20text%20classifier.%20We%26%2339%3Bll%20use%20a%20subset%20of%20Yelp%20Challenge%20Dataset%2C%20which%20contains%20over%204%20million%20Yelp%20reviews%2C%20and%20we%26%2339%3Bll%20train%20our%20classifier" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Linkedin" data-toggle="tooltip" title="" data-original-title="Linkedin"><span class="screen-reader-text">Linkedin</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-reddit fusion-icon-reddit" style="color:#ffffff;background-color:#ff4500;border-color:#ff4500;border-radius:4px;" href="http://reddit.com/submit?url=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/&amp;title=Practical%20Neural%20Networks%20with%20Keras%3A%20Classifying%20Yelp%20Reviews" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Reddit" data-toggle="tooltip" title="" data-original-title="Reddit"><span class="screen-reader-text">Reddit</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-googleplus fusion-icon-googleplus" style="color:#ffffff;background-color:#dc4e41;border-color:#dc4e41;border-radius:4px;" href="https://plus.google.com/share?url=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/" onclick="javascript:window.open(this.href,&#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Google+" data-toggle="tooltip" title="" data-original-title="Google+"><span class="screen-reader-text">Google+</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-pinterest fusion-icon-pinterest" style="color:#ffffff;background-color:#bd081c;border-color:#bd081c;border-radius:4px;" href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2F2017%2F06%2Fpractical-neural-networks-keras-classifying-yelp-reviews%2F&amp;description=Keras%20is%20a%20high-level%20deep%20learning%20library%20that%20makes%20it%20easy%20to%20build%20Neural%20Networks%20in%20a%20few%20lines%20of%20Python.%20In%20this%20post%2C%20we%26%2339%3Bll%20use%20Keras%20to%20train%20a%20text%20classifier.%20We%26%2339%3Bll%20use%20a%20subset%20of%20Yelp%20Challenge%20Dataset%2C%20which%20contains%20over%204%20million%20Yelp%20reviews%2C%20and%20we%26%2339%3Bll%20train%20our%20classifier&amp;media=http%3A%2F%2Fwww.developintelligence.com%2Fblog%2Fwp-content%2Fuploads%2F2017%2F06%2FCopy-of-Copy-of-Copy-of-Creating-Persistent.png" target="_blank" rel="noopener noreferrer" data-placement="top" data-title="Pinterest" data-toggle="tooltip" title="" data-original-title="Pinterest"><span class="screen-reader-text">Pinterest</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-mail fusion-icon-mail fusion-last-social-icon" style="color:#ffffff;background-color:#000000;border-color:#000000;border-radius:4px;" href="mailto:?subject=Practical%20Neural%20Networks%20with%20Keras:%20Classifying%20Yelp%20Reviews&amp;body=http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/" target="_self" rel="noopener noreferrer" data-placement="top" data-title="Email" data-toggle="tooltip" title="" data-original-title="Email"><span class="screen-reader-text">Email</span></a><div class="fusion-clearfix"></div></div></div>			</div>
			
							<div class="fusion-meta-info"><div class="fusion-meta-info-wrapper">
	
			<span class="vcard" style="display: none;">
			<span class="fn">
				<a href="http://www.developintelligence.com/blog/author/gareth/" title="Posts by Gareth Dwyer" rel="author">Gareth Dwyer</a>			</span>
		</span>
	
	

	
	
			<span class="updated" style="display:none;">
			2017-08-17T21:03:59+00:00		</span>
	
<span>June 1st, 2017</span><span class="fusion-inline-sep">|</span><a href="http://www.developintelligence.com/blog/category/python/" rel="category tag">Python</a>, <a href="http://www.developintelligence.com/blog/category/uncategorized/" rel="category tag">Uncategorized</a><span class="fusion-inline-sep">|</span></div></div>								
									</article>
		</div>
<div id="sidebar" class="sidebar fusion-widget-area fusion-content-widget-area" style="float: right;">
						
			<div id="text-4" class="widget widget_text">			<div class="textwidget"><div style="background: #e8e8e8;">

<h3 style="text-align: center; margin: 0; padding: 10px; background: #233345;" data-fontsize="22" data-lineheight="33"><a style="color: #fff;" href="tel:8776295631">(877) 629-5631</a></h3>

<div id="landing-form">
<h2 style="text-align: center; font-size: 1.25em; line-height: 125%; padding-top: 15px;" data-inline-fontsize="true" data-inline-lineheight="true" data-fontsize="20" data-lineheight="25">Get My Custom Training Consultation</h2>

                <div class="gf_browser_chrome gform_wrapper webform-client-form_wrapper" id="gform_wrapper_2"><form method="post" enctype="multipart/form-data" id="gform_2" class="webform-client-form" action="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/">
                        <div class="gform_body"><ul id="gform_fields_2" class="gform_fields top_label form_sublabel_below description_above"><li id="field_2_25" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_25">First Name</label><div class="ginput_container ginput_container_text"><input name="input_25" id="input_2_25" type="text" value="" class="large" tabindex="1" placeholder="First Name" aria-invalid="false"></div></li><li id="field_2_24" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_24">Last Name</label><div class="ginput_container ginput_container_text"><input name="input_24" id="input_2_24" type="text" value="" class="large" tabindex="2" placeholder="Last Name" aria-invalid="false"></div></li><li id="field_2_7" class="gfield gfield_contains_required field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_7">Email<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_email">
                            <input name="input_7" id="input_2_7" type="text" value="" class="large" tabindex="3" placeholder="Email" aria-required="true" aria-invalid="false">
                        </div></li><li id="field_2_27" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_27">Phone (optional)</label><div class="ginput_container ginput_container_phone"><input name="input_27" id="input_2_27" type="text" value="" class="large" tabindex="4" placeholder="Phone (optional)" aria-invalid="false"></div></li><li id="field_2_3" class="gfield gfield_contains_required field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_3">Company/Organization<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_text"><input name="input_3" id="input_2_3" type="text" value="" class="large" tabindex="5" placeholder="Company / Organization" aria-required="true" aria-invalid="false"></div></li><li id="field_2_6" class="gfield gfield_contains_required field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_6">Message<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_textarea"><textarea name="input_6" id="input_2_6" class="textarea small" tabindex="6" placeholder="How can we help?" aria-required="true" aria-invalid="false" rows="10" cols="50"></textarea></div></li><li id="field_2_29" class="gfield field_sublabel_below field_description_above gfield_visibility_visible"><label class="gfield_label" for="input_2_29">CAPTCHA</label><div class="gfield_description">Please enter:</div><div class="gfield_captcha_container"><img class="gfield_captcha" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/1260493563.png" alt="" width="150" height="42"><div class="gfield_captcha_input_container simple_captcha_medium"><input type="text" name="input_29" id="input_2_29" tabindex="7"><input type="hidden" name="input_captcha_prefix_29" value="1260493563"></div></div></li><li id="field_2_28" class="gfield gform_hidden field_sublabel_below field_description_above gfield_visibility_visible"><input name="input_28" id="input_2_28" type="hidden" class="gform_hidden" aria-invalid="false" value=""></li><li id="field_2_14" class="gfield gform_hidden field_sublabel_below field_description_above gfield_visibility_visible"><input name="input_14" id="input_2_14" type="hidden" class="gform_hidden" aria-invalid="false" value="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/https://www.google.com/"></li><li id="field_2_26" class="gfield gform_hidden field_sublabel_below field_description_above gfield_visibility_visible"><input name="input_26" id="input_2_26" type="hidden" class="gform_hidden" aria-invalid="false" value="Web Lead - Blog"></li><li id="field_2_30" class="gfield gform_validation_container field_sublabel_below field_description_above gfield_visibility_"><label class="gfield_label" for="input_2_30">Name</label><div class="gfield_description">This field is for validation purposes and should be left unchanged.</div><div class="ginput_container"><input name="input_30" id="input_2_30" type="text" value=""></div></li>
                            </ul></div>
        <div class="gform_footer top_label"> <input type="submit" id="gform_submit_button_2" class="gform_button button" value="Submit" tabindex="8" onclick="if(window[&quot;gf_submitting_2&quot;]){return false;}  window[&quot;gf_submitting_2&quot;]=true;  " onkeypress="if( event.keyCode == 13 ){ if(window[&quot;gf_submitting_2&quot;]){return false;} window[&quot;gf_submitting_2&quot;]=true;  jQuery(&quot;#gform_2&quot;).trigger(&quot;submit&quot;,[true]); }"><!-- Begin Daddy Analytics fields --><input type="hidden" name="" value=""><input type="hidden" name="" value=""><!-- End Daddy Analytics fields --> 
            <input type="hidden" class="gform_hidden" name="is_submit_2" value="1">
            <input type="hidden" class="gform_hidden" name="gform_submit" value="2">
            
            <input type="hidden" class="gform_hidden" name="gform_unique_id" value="">
            <input type="hidden" class="gform_hidden" name="state_2" value="WyJbXSIsImYyNmMzNGQzYjI3MTg3NzBkYmU3MTA4OTM5ZjA2M2RlIl0=">
            <input type="hidden" class="gform_hidden" name="gform_target_page_number_2" id="gform_target_page_number_2" value="0">
            <input type="hidden" class="gform_hidden" name="gform_source_page_number_2" id="gform_source_page_number_2" value="1">
            <input type="hidden" name="gform_field_values" value="">
            
        </div>
                        </form>
                        </div><script type="text/javascript"> jQuery(document).bind('gform_post_render', function(event, formId, currentPage){if(formId == 2) {if(typeof Placeholders != 'undefined'){
                        Placeholders.enable();
                    }if(!/(android)/i.test(navigator.userAgent)){jQuery('#input_2_27').mask('(999) 999-9999').bind('keypress', function(e){if(e.which == 13){jQuery(this).blur();} } );}} } );jQuery(document).bind('gform_post_conditional_logic', function(event, formId, fields, isInit){} );</script><script type="text/javascript"> jQuery(document).ready(function(){jQuery(document).trigger('gform_post_render', [2, 1]) } ); </script>
</div>

</div></div>
		</div><div id="text-5" class="widget widget_text">			<div class="textwidget"><div style="background: #e8e8e8;margin-bottom: 30px;">
	<div style="padding-top: 15px;">
    	        <div style="padding: 0 20px 20px 15px;
line-height: 170%;
    font-size: 14px;
    color: #666666;
    overflow: hidden;
    font-family: Source Sans Pro,Arial,sans-serif;
">
            <p style="
    padding-bottom: 10px;
    line-height: 150%;
    font-size: 15px;
"><span style="color: #f48035 !important;">
DevelopIntelligence</span> has been in the technical/software development learning and training industry for nearly 20 years. We’ve provided learning solutions to more than 48,000 engineers, across 220 organizations worldwide. </p>
<img src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/about-di.png" alt="About Develop Intelligence" style="
    display: inline;
    margin-right: 15px;
    float: left;
    text-align: left;
">        </div>
    </div>
</div></div>
		</div>	</div>

				</div>  <!-- fusion-row -->
			</div>  <!-- #main -->
			
			
			
			
										
				<div class="fusion-footer">

																
						<footer class="fusion-footer-widget-area fusion-widget-area">
							<div class="fusion-row">
								<div class="fusion-columns fusion-columns-4 fusion-widget-area">
									
																																							<div class="fusion-column col-lg-3 col-md-3 col-sm-3">
												<div id="nav_menu-2" class="fusion-footer-widget-column widget widget_nav_menu"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">About Us</h4><div class="menu-footer-menu-1-container"><ul id="menu-footer-menu-1" class="menu"><li id="menu-item-6836" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6836"><a href="http://www.developintelligence.com/why-choose-developintelligence/testimonials">Testimonials</a></li>
<li id="menu-item-6837" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-6837"><a href="http://www.developintelligence.com/blog">Be Smart Blog</a></li>
<li id="menu-item-6838" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6838"><a href="http://www.developintelligence.com/why-choose-developintelligence/partners">Partners</a></li>
<li id="menu-item-6839" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6839"><a href="http://www.developintelligence.com/why-choose-developintelligence/giving-back">Giving Back</a></li>
<li id="menu-item-6840" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6840"><a href="http://www.developintelligence.com/we-are-hiring">Join The Team</a></li>
<li id="menu-item-6841" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6841"><a href="http://www.developintelligence.com/why-choose-developintelligence/in-the-news">In the News</a></li>
<li id="menu-item-6842" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6842"><a href="http://www.developintelligence.com/blog/2017-developer-learning-survey-report-free-report/">2017 Developer Report</a></li>
<li id="menu-item-6843" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6843"><a href="http://www.developintelligence.com/learn/tutorials">Tutorials</a></li>
</ul></div><div style="clear:both;"></div></div>																																				</div>
																																								<div class="fusion-column col-lg-3 col-md-3 col-sm-3">
												<div id="nav_menu-3" class="fusion-footer-widget-column widget widget_nav_menu"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">Training Options</h4><div class="menu-footer-menu-2-container"><ul id="menu-footer-menu-2" class="menu"><li id="menu-item-6826" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6826"><a href="http://www.developintelligence.com/catalog/type/hands-on">Hands-On Training Courses</a></li>
<li id="menu-item-6827" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6827"><a href="http://www.developintelligence.com/catalog/type/boot-camp">Bootcamp Courses</a></li>
<li id="menu-item-6828" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6828"><a href="http://www.developintelligence.com/catalog/type/workshop">Learn to Code Workshops</a></li>
<li id="menu-item-6829" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6829"><a href="http://www.developintelligence.com/solutions/teams/mentored-prototype-development">Expert-Led Prototyping</a></li>
<li id="menu-item-6844" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6844"><a href="http://www.developintelligence.com/catalog/skill">Courses by Skill Level</a></li>
<li id="menu-item-6845" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6845"><a href="http://www.developintelligence.com/catalog/role">Courses by Role</a></li>
</ul></div><div style="clear:both;"></div></div>																																				</div>
																																								<div class="fusion-column col-lg-3 col-md-3 col-sm-3">
												<div id="nav_menu-4" class="fusion-footer-widget-column widget widget_nav_menu"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">Courses by Category</h4><div class="menu-footer-menu-3-container"><ul id="menu-footer-menu-3" class="menu"><li id="menu-item-6830" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6830"><a href="http://www.developintelligence.com/catalog/it-training">All Courses (IT Training)</a></li>
<li id="menu-item-6831" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6831"><a href="http://www.developintelligence.com/catalog/agile-training">Agile Training</a></li>
<li id="menu-item-6832" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6832"><a href="http://www.developintelligence.com/catalog/apache-training">Apache Training</a></li>
<li id="menu-item-6846" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6846"><a href="http://www.developintelligence.com/catalog/google-training">Google Training</a></li>
<li id="menu-item-6847" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6847"><a href="http://www.developintelligence.com/catalog/j2ee-training-java-ee-training">Java EE Training</a></li>
<li id="menu-item-6848" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6848"><a href="http://www.developintelligence.com/catalog/javascript-training">JavaScript Training</a></li>
<li id="menu-item-6849" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6849"><a href="http://www.developintelligence.com/catalog/jboss-training">JBoss Training</a></li>
<li id="menu-item-6850" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6850"><a href="http://www.developintelligence.com/catalog/mysql-training">MySQL Training</a></li>
<li id="menu-item-6851" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6851"><a href="http://www.developintelligence.com/catalog/ruby-training">Ruby Training</a></li>
<li id="menu-item-6852" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6852"><a href="http://www.developintelligence.com/catalog/open-source-training/scala">Scala Training</a></li>
<li id="menu-item-6853" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6853"><a href="http://www.developintelligence.com/catalog/spring-source-training">SpringSource Training</a></li>
<li id="menu-item-6854" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6854"><a href="http://www.developintelligence.com/catalog/zend-training">Zend Training</a></li>
</ul></div><div style="clear:both;"></div></div>																																				</div>
																																								<div class="fusion-column fusion-column-last col-lg-3 col-md-3 col-sm-3">
												<div id="text-7" class="fusion-footer-widget-column widget widget_text"><h4 class="widget-title" data-fontsize="16" data-lineheight="24">Let’s Discuss</h4>			<div class="textwidget"><div id="menu">
<p><span class="orange-text">DevelopIntelligence</span> has been in the technical/software development learning and training industry for nearly 20 years. We’ve provided learning solutions to more than 48,000 engineers, across 220 organizations worldwide. </p>
<h4 data-fontsize="18" data-lineheight="27"><span class="orange-text"><a href="http://www.developintelligence.com/contact-developintelligence">Let's discuss your training goals.</a>
</span></h4></div></div>
		<div style="clear:both;"></div></div>																																				</div>
																																																									
									<div class="fusion-clearfix"></div>
								</div> <!-- fusion-columns -->
							</div> <!-- fusion-row -->
						</footer> <!-- fusion-footer-widget-area -->
					
																
						<footer id="footer" class="fusion-footer-copyright-area fusion-footer-copyright-center">
							<div class="fusion-row">
								<div class="fusion-copyright-content">

											<div class="fusion-copyright-notice" style="padding-bottom: 0px;">
			<div>Copyright; 2017, Develop Intelligence | All Rights Reserved.
</div>
		</div>
					<div class="fusion-social-links-footer" style="display: none;">
							</div>
		
								</div> <!-- fusion-fusion-copyright-content -->
							</div> <!-- fusion-row -->
						</footer> <!-- #footer -->
														</div> <!-- fusion-footer -->
					</div> <!-- wrapper -->

				
		<a class="fusion-one-page-text-link fusion-page-load-link"></a>

		<!-- W3TC-include-js-head -->

		<script>
window.onload = function() {
 
 var link = document.querySelector("a.fusion-logo-link");
 link.setAttribute("href", "http://www.developintelligence.com/");
};
</script>

<link rel="stylesheet" id="gforms_reset_css-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/formreset.min.css" type="text/css" media="all">
<link rel="stylesheet" id="gforms_formsmain_css-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/formsmain.min.css" type="text/css" media="all">
<link rel="stylesheet" id="gforms_ready_class_css-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/readyclass.min.css" type="text/css" media="all">
<link rel="stylesheet" id="gforms_browsers_css-css" href="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/browsers.min.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var code_prettify_settings = {"base_url":"http:\/\/www.developintelligence.com\/blog\/wp-content\/plugins\/code-prettify\/prettify"};
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
var leadin_wordpress = {"userRole":"visitor","pageType":"post","leadinPluginVersion":"6.1.4"};
/* ]]> */
</script>
<script type="text/javascript" async="" defer="" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/550954.js(2).下载"></script>
<script type="text/javascript">
/* <![CDATA[ */
var toTopscreenReaderText = {"label":"Go to Top"};
var avadaVars = {"admin_ajax":"http:\/\/www.developintelligence.com\/blog\/wp-admin\/admin-ajax.php","admin_ajax_nonce":"222b0f6979","protocol":"","theme_url":"http:\/\/www.developintelligence.com\/blog\/wp-content\/themes\/Avada","dropdown_goto":"Go to...","mobile_nav_cart":"Shopping Cart","page_smoothHeight":"false","flex_smoothHeight":"false","language_flag":"","infinite_blog_finished_msg":"<em>All posts displayed.<\/em>","infinite_finished_msg":"<em>All items displayed.<\/em>","infinite_blog_text":"<em>Loading the next set of posts...<\/em>","portfolio_loading_text":"<em>Loading Portfolio Items...<\/em>","faqs_loading_text":"<em>Loading FAQ Items...<\/em>","order_actions":"Details","avada_rev_styles":"0","avada_styles_dropdowns":"1","blog_grid_column_spacing":"40","blog_pagination_type":"Pagination","carousel_speed":"2500","counter_box_speed":"1000","content_break_point":"800","disable_mobile_animate_css":"0","disable_mobile_image_hovers":"1","portfolio_pagination_type":"Pagination","form_bg_color":"#ffffff","header_transparency":"0","header_padding_bottom":"0px","header_padding_top":"0px","header_position":"Top","header_sticky":"1","header_sticky_tablet":"0","header_sticky_mobile":"0","header_sticky_type2_layout":"menu_only","sticky_header_shrinkage":"1","is_responsive":"1","is_ssl":"false","isotope_type":"masonry","layout_mode":"wide","lightbox_animation_speed":"Normal","lightbox_arrows":"1","lightbox_autoplay":"0","lightbox_behavior":"all","lightbox_desc":"1","lightbox_deeplinking":"1","lightbox_gallery":"1","lightbox_opacity":"0.9","lightbox_path":"vertical","lightbox_post_images":"1","lightbox_skin":"metro-white","lightbox_slideshow_speed":"5000","lightbox_social":"1","lightbox_title":"1","lightbox_video_height":"720","lightbox_video_width":"1280","logo_alignment":"Left","logo_margin_bottom":"10px","logo_margin_top":"10px","megamenu_max_width":"1100","mobile_menu_design":"modern","nav_height":"70","nav_highlight_border":"0","page_title_fading":"0","pagination_video_slide":"0","related_posts_speed":"2500","submenu_slideout":"1","side_header_break_point":"800","sidenav_behavior":"Hover","site_width":"95%","slider_position":"below","slideshow_autoplay":"1","slideshow_speed":"7000","smooth_scrolling":"0","status_lightbox":"1","status_totop_mobile":"0","status_vimeo":"1","status_yt":"1","testimonials_speed":"4000","tfes_animation":"sides","tfes_autoplay":"1","tfes_interval":"3000","tfes_speed":"800","tfes_width":"150","title_style_type":"double","title_margin_top":"0px","title_margin_bottom":"31px","typography_responsive":"0","typography_sensitivity":"0.6","typography_factor":"1.5","woocommerce_shop_page_columns":"","woocommerce_checkout_error":"Not all fields have been filled in correctly.","side_header_width":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/main.min.js.下载" async=""></script> 
<!--[if IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/avada-ie9.js?ver=5.0.6'></script>
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.developintelligence.com/blog/wp-content/themes/Avada/assets/js/respond.js?ver=5.0.6'></script>
<![endif]-->
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/wp-embed.min.js.下载"></script>
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/jquery.maskedinput.min.js.下载"></script>
<script type="text/javascript" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/placeholders.jquery.min.js.下载"></script>
<!-- Facebook Comments Plugin for WordPress: http://peadig.com/wordpress-plugins/facebook-comments/ -->
<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/lY4eZXm_YWu.html" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/lY4eZXm_YWu(1).html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="f356203ed7e47e" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/ping.html" style="display: none;"></iframe></div></div></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=708166696026776&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

		<script type="text/javascript">
_linkedin_data_partner_id = "95643";
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
&lt;img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=95643&amp;fmt=gif" /&gt;
</noscript>	
<div class="to-top-container"><a href="http://www.developintelligence.com/blog/2017/06/practical-neural-networks-keras-classifying-yelp-reviews/#" id="toTop" style="display: inline; opacity: 0.899;"><span id="toTopHover"></span><span class="screen-reader-text">Go to Top</span></a></div><script src="./Practical Neural Networks with Keras_ Classifying Yelp Reviews _ DevelopIntelligence Blog_files/saved_resource" type="text/javascript"></script></body></html>